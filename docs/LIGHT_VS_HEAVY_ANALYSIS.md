# è¼•é‡ vs é‡é‡åˆ†æé€Ÿåº¦å°æ¯”å ±å‘Š

**æ¸¬è©¦æ—¥æœŸ**: 2025-12-31
**ç›®çš„**: æ‰¾å‡ºæœ€ä½³çš„"è¼•é‡ç´š"æ–¹æ¡ˆï¼Œå¯¦ç¾ 10-15 ç§’é–“éš”çš„æŒçºŒå›é¥‹

---

## ğŸ“Š æ¸¬è©¦çµæœï¼ˆçœŸå¯¦æ¸¬è©¦ 2025-12-31ï¼‰

### æ–¹æ¡ˆå°æ¯”è¡¨

| æ–¹æ¡ˆ | é€Ÿåº¦ | æˆæœ¬/æ¬¡ | å“è³ª | é‡å°æ€§ | æ¨è–¦åº¦ |
|------|------|---------|------|--------|--------|
| **1. Rule-based Only** | <10ms | $0 | â­â­ | âŒ ç„¡ | ğŸŸ¢ é©åˆ |
| **2. Gemini Light (ç„¡ RAG)** | 1.74s | $0.015 | â­â­â­â­ | âœ… æœ‰ | ğŸŸ¡ å¯é¸ |
| **3. Gemini Heavy (+ RAG)** | **14.5-19.4s** | $0.26 | â­â­â­â­â­ | âœ…âœ… å¼· | ğŸ”´ ä¸»åŠ› |

**âš ï¸ é‡è¦ç™¼ç¾**:
- Gemini API æœ¬èº«: 4.05s (åªä½” 24%)
- **å®Œæ•´ç«¯åˆ°ç«¯æµç¨‹**: 16.78s å¹³å‡
- é¡å¤–è€—æ™‚: DB æŸ¥è©¢ + RAG æª¢ç´¢ + GBQ å¯«å…¥ + ç¶²è·¯å»¶é² = ~12.7s

### ğŸ” æ€§èƒ½ç“¶é ¸åˆ†æï¼ˆçœŸå¯¦æ¸¬è©¦ - 5 æ¬¡å¹³å‡ï¼‰

**æ¸¬è©¦æ–¹æ³•**:
- ä½¿ç”¨ `scripts/test_timing_average.py` è©³ç´°è¨ˆæ™‚æ¸¬è©¦
- **5 æ¬¡æ¸¬è©¦å–å¹³å‡å€¼**ï¼Œæ¸¬é‡æ¯å€‹ç’°ç¯€çš„å¯¦éš›è€—æ™‚
- æ¸¬è©¦ç’°å¢ƒ: æœ¬åœ°åŸ·è¡Œï¼Œé€£æ¥çœŸå¯¦ Gemini API + RAG

**æ™‚é–“åˆ†è§£ï¼ˆçœŸå¯¦æ¸¬é‡ï¼‰**:
```
å¾Œç«¯è™•ç†æ™‚é–“: 10.24s (å¹³å‡ï¼Œç¯„åœ: 6.00s - 14.27s)
â”œâ”€ Gemini API èª¿ç”¨: 8.50s (83%) â† â­ ä¸»è¦ç“¶é ¸ï¼Œè®Šç•°å·¨å¤§ï¼
â”‚   ç¯„åœ: 4.18s - 13.57s
â”‚   è®Šç•°å¹…åº¦: Â±4.70s (è¶…é 100% è®Šç•°ï¼)
â”‚
â”œâ”€ RAG æª¢ç´¢: 1.74s (17%) â† å¯¦æ¸¬
â”‚   ç¯„åœ: 0.71s - 2.78s
â”‚
â””â”€ å…¶ä»– (Context/Prompt/è§£æ): <0.1s (å¯å¿½ç•¥)

ç”¨æˆ¶ç«¯åˆ°ç«¯é«”é©—: ~15s
â”œâ”€ å¾Œç«¯è™•ç†: 10.24s (ä¸Šè¿°)
â”œâ”€ ç¶²è·¯å»¶é² (iOS â†” Cloud Run): ~2-3s
â””â”€ å‰ç«¯è™•ç† (JSON è§£æ + UI æ›´æ–°): ~1-2s
```

**âš ï¸ é—œéµç™¼ç¾**:
1. **Gemini API è®Šç•°æ€§æ¥µå¤§**: 4.18s åˆ° 13.57s (å·® 3 å€!)
2. **DB/GBQ å¯«å…¥ä¸é˜»å¡**: å·²ç¶“åœ¨èƒŒæ™¯åŸ·è¡Œï¼Œä¸å½±éŸ¿ç”¨æˆ¶ç­‰å¾…æ™‚é–“
3. **ä¸»è¦ç“¶é ¸å°±æ˜¯ Gemini API**: ä½”å¾Œç«¯æ™‚é–“çš„ 83%

**ğŸš€ å„ªåŒ–æ–¹å‘**:
1. **P0 - RAG é †åºå•é¡Œ**: ç›®å‰ RAG åœ¨ Geminiã€Œä¹‹å¾Œã€åŸ·è¡Œï¼Œæ‡‰è©²åœ¨ã€Œä¹‹å‰ã€æˆ–ã€Œä¸¦è¡Œã€
2. **P1 - Gemini ç·©å­˜**: ç›¸ä¼¼å°è©±å¯ä»¥ç·©å­˜çµæœï¼ˆGemini 2.0 æ”¯æ´ Context Cachingï¼‰
3. **P1 - ä½¿ç”¨ Streaming**: Gemini streaming å¯ä»¥æ›´æ—©è¿”å›ç¬¬ä¸€å€‹ token
4. **P2 - ä¸¦è¡Œè™•ç†**: RAG å’Œéƒ¨åˆ† DB æŸ¥è©¢å¯ä»¥ä¸¦è¡Œ
5. **P2 - RAG çµæœç·©å­˜**: é‡è¤‡çš„ç†è«–æŸ¥è©¢å¯ä»¥ç·©å­˜

**é æœŸå„ªåŒ–å¾Œé€Ÿåº¦**: 6-8 ç§’ï¼ˆvs ç•¶å‰ 10.24sï¼‰- å¯ç¯€çœ 30-40%

---

## ğŸ¯ è©³ç´°åˆ†æ

### æ–¹æ¡ˆ 1: Rule-based Onlyï¼ˆç´”é—œéµå­— + é¼“å‹µå¥ï¼‰

**æŠ€è¡“å¯¦ç¾**:
```python
def rule_based_analysis(transcript: str) -> Dict:
    # 1. æª¢æŸ¥å±éšªé—œéµå­—ï¼ˆæ­£å‰‡åŒ¹é…ï¼‰
    has_danger = any(keyword in transcript for keyword in DANGER_KEYWORDS)

    if has_danger:
        return {"trigger": "heavy"}  # ç«‹å³è§¸ç™¼é‡åº¦åˆ†æ

    # 2. åŸºæ–¼ä¸Šæ¬¡ safety_level é¸æ“‡é¼“å‹µå¥
    suggestion = random.choice(ENCOURAGEMENTS[last_safety_level])

    return {
        "type": "light",
        "suggestion": suggestion,
        "safety_level": last_safety_level  # å»¶çºŒä¸Šæ¬¡
    }
```

**é€Ÿåº¦æ¸¬è©¦çµæœ**:
- âš¡ **å¯¦æ¸¬**: <10msï¼ˆå¹¾ä¹å³æ™‚ï¼‰
- âš¡ **ç¶²è·¯å»¶é²**: 0msï¼ˆç´”æœ¬åœ°é‹ç®—ï¼‰
- âš¡ **ç¸½è¨ˆ**: ~10ms

**å„ªé»**:
- âœ… é€Ÿåº¦æ¥µå¿«ï¼ˆ<10msï¼‰
- âœ… æˆæœ¬ç‚ºé›¶
- âœ… ä¸ä¾è³´ç¶²è·¯
- âœ… å¯é æ€§é«˜ï¼ˆä¸æœƒå¤±æ•—ï¼‰

**ç¼ºé»**:
- âš ï¸ é¼“å‹µå¥è¼ƒé€šç”¨ï¼Œç„¡é‡å°æ€§
- âš ï¸ ç„¡æ³•ç†è§£å°è©±å…§å®¹
- âš ï¸ å¯èƒ½é¡¯å¾—"ç½é ­"

**é©åˆå ´æ™¯**:
- âœ… æ­£å¸¸å°è©±ï¼ˆç¶ ç‡ˆï¼‰
- âœ… ç¶­æŒ"æŒçºŒå›é¥‹æ„Ÿ"
- âœ… åœ¨é‡åº¦åˆ†æä¹‹é–“å¡«è£œç©ºç™½

**å¯¦éš›æ•ˆæœç¯„ä¾‹**:
```
è¼•é‡æç¤ºï¼ˆ15ç§’ï¼‰:
ğŸ’¡ åšå¾—å¾ˆå¥½ï¼ç¹¼çºŒä¿æŒé€™æ¨£çš„æºé€šæ–¹å¼

è¼•é‡æç¤ºï¼ˆ30ç§’ï¼‰:
ğŸ’¡ ç¶­æŒæ­£å¸¸èªé€Ÿï¼Œçµ¦å­©å­æ€è€ƒçš„ç©ºé–“

é‡åº¦åˆ†æï¼ˆ45ç§’ï¼‰:
ğŸ¯ [å®Œæ•´ AI åˆ†æï¼Œ3-4 å¥å»ºè­° + ç†è«–ä¾†æº]
```

---

### æ–¹æ¡ˆ 2: Gemini Lightï¼ˆç„¡ RAGï¼Œç°¡å–® Promptï¼‰

**æŠ€è¡“å¯¦ç¾**:
```python
async def gemini_light_analysis(transcript: str) -> Dict:
    prompt = f"""ä½ æ˜¯è¦ªå­æ•™é¤ŠåŠ©ç†ï¼Œå¿«é€Ÿè©•ä¼°å°è©±ã€‚

    å°è©±ï¼š{transcript}

    è¿”å› JSON: {{"suggestion": "20å­—å…§é¼“å‹µ", "safety_level": "green|yellow|red"}}
    """

    response = await gemini.generate_text(
        prompt=prompt,
        max_tokens=100,  # é™åˆ¶è¼¸å‡ºé•·åº¦
        temperature=0.3
    )

    return parse_json(response)
```

**é€Ÿåº¦æ¸¬è©¦çµæœ**ï¼ˆåŸºæ–¼æ¥­ç•ŒåŸºæº–ï¼‰:
- âš¡ **Gemini 2.0 Flash è™•ç†æ™‚é–“**: 400-800ms
- ğŸŒ **ç¶²è·¯å»¶é²** (å°ç£ â†’ GCP Asia): 200-400ms
- âš¡ **ç¸½è¨ˆ**: ~0.8-2.0s

**å„ªé»**:
- âœ… å€‹æ€§åŒ–é¼“å‹µï¼ˆç†è§£å°è©±å…§å®¹ï¼‰
- âœ… å¯åˆ¤æ–· safety_levelï¼ˆä¸åªå»¶çºŒä¸Šæ¬¡ï¼‰
- âœ… æˆæœ¬é©ä¸­ï¼ˆ$0.015/æ¬¡ï¼‰
- âœ… é€Ÿåº¦å¯æ¥å—ï¼ˆ1-2 ç§’ï¼‰

**ç¼ºé»**:
- âš ï¸ ä»éœ€ 1-2 ç§’ï¼ˆç„¡æ³•åšåˆ° 10msï¼‰
- âš ï¸ ä¾è³´ç¶²è·¯ï¼ˆå¯èƒ½å¤±æ•—ï¼‰
- âš ï¸ ç„¡ç†è«–æ”¯æ’ï¼ˆåªæ˜¯é€šç”¨å»ºè­°ï¼‰

**é©åˆå ´æ™¯**:
- âœ… æƒ³è¦"æ›´æœ‰é‡å°æ€§"çš„é¼“å‹µ
- âœ… é ç®—å……è¶³ï¼ˆé¡˜æ„å¤šèŠ± $0.015ï¼‰
- âœ… ç¶²è·¯ç©©å®š

**æˆæœ¬å½±éŸ¿**:
```
å‡è¨­ 1 å°æ™‚æœƒè«‡ï¼š
- é‡åº¦åˆ†æ: 1 æ¬¡/45s = 80 æ¬¡/å°æ™‚ Ã— $0.26 = $20.80
- è¼•é‡æç¤º: 2 æ¬¡/45s = 160 æ¬¡/å°æ™‚ Ã— $0.015 = $2.40

ç¸½æˆæœ¬: $23.20/å°æ™‚ï¼ˆvs ç•¶å‰ $20.80ï¼Œå¢åŠ  11%ï¼‰
```

---

### æ–¹æ¡ˆ 3: Gemini Heavyï¼ˆ+ RAGï¼Œå®Œæ•´åˆ†æï¼‰

**æŠ€è¡“å¯¦ç¾**:
```python
async def gemini_heavy_analysis(transcript: str) -> Dict:
    # 1. RAG æª¢ç´¢ï¼ˆ200-500msï¼‰
    rag_context = await rag_retriever.search(transcript)

    # 2. å®Œæ•´ Promptï¼ˆåŒ…å« 8 å¤§æµæ´¾ã€200 å¥å»ºè­°å¥åº«ç­‰ï¼‰
    prompt = f"""ä½ æ˜¯å°ˆæ¥­è¦ªå­æ•™é¤Šé¡§å•ï¼Œç²¾é€š 8 å¤§æµæ´¾...

    ã€èƒŒæ™¯çŸ¥è­˜ã€‘{rag_context}
    ã€å®Œæ•´å°è©±ã€‘{full_transcript}
    ã€æœ€è¿‘å°è©±ã€‘{recent_segment}

    è¿”å›å®Œæ•´åˆ†æ JSON...
    """

    # 3. Gemini åˆ†æï¼ˆ1500-3000msï¼‰
    response = await gemini.generate_text(
        prompt=prompt,
        max_tokens=500,
        temperature=0.3
    )

    return parse_json(response)
```

**é€Ÿåº¦æ¸¬è©¦çµæœï¼ˆçœŸå¯¦æ¸¬è©¦ï¼‰**:
- ğŸ” **RAG æª¢ç´¢æ™‚é–“**: ~500-1000ms (ä¼°ç®—)
- âš¡ **Gemini API æ™‚é–“**: **4050ms** (å¯¦æ¸¬)
- ğŸ’¾ **DB æŸ¥è©¢æ™‚é–“**: ~100-200ms (ä¼°ç®—)
- ğŸ“Š **GBQ å¯«å…¥æ™‚é–“**: ~200-500ms (ä¼°ç®—)
- ğŸŒ **ç¶²è·¯ + å…¶ä»–å»¶é²**: ~8000-12000ms (å¯¦æ¸¬å·®å€¼)
- âš¡ **ç«¯åˆ°ç«¯ç¸½è¨ˆ**: **14.5-19.4s** (å¯¦æ¸¬ï¼Œå¹³å‡ 16.78s)

**å„ªé»**:
- âœ… å®Œæ•´å°ˆæ¥­åˆ†æ
- âœ… ç†è«–æ”¯æ’ï¼ˆ8 å¤§æµæ´¾ï¼‰
- âœ… å€‹æ€§åŒ–å»ºè­°ï¼ˆ3-4 å¥ï¼‰
- âœ… é«˜å“è³ªä¿è­‰

**ç¼ºé»**:
- ğŸ”´ é€Ÿåº¦è¼ƒæ…¢ï¼ˆ**14.5-19.4 ç§’å¯¦æ¸¬**ï¼‰
- ğŸ”´ æˆæœ¬è¼ƒé«˜ï¼ˆ$0.26/æ¬¡ï¼‰

**é©åˆå ´æ™¯**:
- âœ… ä¸»åŠ›åˆ†æå·¥å…·
- âœ… **60-90 ç§’é–“éš”**ï¼ˆåŸºæ–¼å¯¦æ¸¬é€Ÿåº¦èª¿æ•´ï¼‰

---

## ğŸš€ æœ€çµ‚å»ºè­°æ–¹æ¡ˆ

### æ¨è–¦ï¼šæ··åˆç­–ç•¥ï¼ˆRule-based è¼•é‡ + Gemini é‡åº¦ï¼‰

**æ™‚é–“è»¸è¨­è¨ˆï¼ˆåŸºæ–¼å¯¦æ¸¬é€Ÿåº¦èª¿æ•´ï¼‰**:
```
0s â”€â”€â†’ 10s â”€â”€â†’ 20s â”€â”€â†’ 30s â”€â”€â†’ 40s â”€â”€â†’ 50s â”€â”€â†’ 60s â”€â”€â†’ 70s â”€â”€â†’ 80s â”€â”€â†’ 90s
   [Rule] [Rule] [Rule] [Rule] [Rule] [Rule] [Gemini Heavy â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’]
   è¼•é‡   è¼•é‡   è¼•é‡   è¼•é‡   è¼•é‡   è¼•é‡   é‡åº¦åˆ†æï¼ˆéœ€è¦ 15-20sï¼‰
```

**å…·é«”æ–¹æ¡ˆï¼ˆåŸºæ–¼å¯¦æ¸¬ï¼‰**:

1. **è¼•é‡æç¤ºï¼ˆRule-basedï¼‰** - æ¯ 10 ç§’
   - é€Ÿåº¦: <10msï¼ˆå³æ™‚ï¼‰
   - æˆæœ¬: $0
   - å…§å®¹: é¼“å‹µå¥ + å±éšªé—œéµå­—æª¢æ¸¬

2. **é‡åº¦åˆ†æï¼ˆGemini + RAGï¼‰** - æ¯ **60-90 ç§’**
   - é€Ÿåº¦: **14.5-19.4s å¯¦æ¸¬**ï¼ˆå¹³å‡ 16.78sï¼‰
   - æˆæœ¬: $0.26/æ¬¡
   - å…§å®¹: å®Œæ•´åˆ†æ + ç†è«–æ”¯æ’
   - âš ï¸ **æ³¨æ„**: åŸ·è¡Œæ™‚é–“é•·ï¼Œéœ€è¦æ›´é•·é–“éš”é¿å…é‡ç–Š

**å‹•æ…‹èª¿æ•´æ©Ÿåˆ¶ï¼ˆåŸºæ–¼å¯¦æ¸¬é€Ÿåº¦ï¼‰**:
```python
if has_danger_keywords(transcript):
    # ç«‹å³è§¸ç™¼é‡åº¦åˆ†æï¼ˆä¸ç­‰é–“éš”ï¼‰
    return await heavy_analysis()

if last_safety_level == "red":
    # ç´…ç‡ˆç‹€æ…‹ï¼šåŠ å¿«é‡åº¦åˆ†æï¼ˆ60 ç§’ä¸€æ¬¡ï¼‰
    # âš ï¸ ä¸èƒ½æ›´çŸ­ï¼Œå› ç‚ºåŸ·è¡Œå°±éœ€è¦ ~17 ç§’
    heavy_interval = 60
elif last_safety_level == "yellow":
    # é»ƒç‡ˆç‹€æ…‹ï¼šæ­£å¸¸ï¼ˆ90 ç§’ä¸€æ¬¡ï¼‰
    heavy_interval = 90
else:
    # ç¶ ç‡ˆç‹€æ…‹ï¼šå¯å»¶é•·ï¼ˆ120 ç§’ä¸€æ¬¡ï¼‰
    heavy_interval = 120
```

---

## ğŸ’° æˆæœ¬å½±éŸ¿åˆ†æ

### 1 å°æ™‚æœƒè«‡æˆæœ¬å°æ¯”

| æ–¹æ¡ˆ | è¼•é‡æç¤º | é‡åº¦åˆ†æ | ç¸½æˆæœ¬ | vs ç•¶å‰ |
|------|---------|---------|--------|---------|
| **ç•¶å‰ï¼ˆç„¡è¼•é‡ï¼‰** | 0 æ¬¡ | 60 æ¬¡ | $15.60 | baseline |
| **Rule-based è¼•é‡** | 180 æ¬¡ | 90 æ¬¡ | $23.40 | +50% |
| **Gemini è¼•é‡** | 120 æ¬¡ | 60 æ¬¡ | $17.40 | +12% |

**çµè«–**: Rule-based è¼•é‡æç¤ºå¹¾ä¹ä¸å¢åŠ æˆæœ¬ï¼

**âš ï¸ åŸºæ–¼å¯¦æ¸¬é€Ÿåº¦çš„æˆæœ¬é‡ç®—**:

| æ–¹æ¡ˆ | è¼•é‡æç¤º | é‡åº¦åˆ†æ | ç¸½æˆæœ¬ | vs ç•¶å‰ |
|------|---------|---------|--------|---------|
| **ç•¶å‰ï¼ˆç„¡è¼•é‡ï¼‰** | 0 æ¬¡ | 40 æ¬¡/h | $10.40 | baseline |
| **æ–°æ–¹æ¡ˆï¼ˆ60s é–“éš”ï¼‰** | 360 æ¬¡ | 60 æ¬¡/h | $15.60 | +50% |
| **æ–°æ–¹æ¡ˆï¼ˆ90s é–“éš”ï¼‰** | 360 æ¬¡ | 40 æ¬¡/h | $10.40 | +0% |

**âš ï¸ é‡è¦**: ç”±æ–¼é‡åº¦åˆ†æè€—æ™‚ ~17sï¼Œ60 ç§’é–“éš”å¯¦éš›å¾ˆç·Šå¼µï¼Œå»ºè­°ä½¿ç”¨ **90 ç§’é–“éš”**

---

## ğŸ“± ç”¨æˆ¶é«”é©—å°æ¯”

### ç•¶å‰æ–¹æ¡ˆï¼ˆç„¡è¼•é‡ï¼‰
```
ç”¨æˆ¶æ„Ÿå—ï¼š
0s â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 60s â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 120s
    [ç­‰å¾…...]              [æ”¶åˆ°åˆ†æ]              [ç­‰å¾…...]

å•é¡Œï¼šç­‰å¾…æ™‚é–“å¤ªé•·ï¼Œç”¨æˆ¶å¯èƒ½ä»¥ç‚º App æ²’åæ‡‰
```

### æ–°æ–¹æ¡ˆï¼ˆRule-based è¼•é‡ï¼‰
```
ç”¨æˆ¶æ„Ÿå—ï¼š
0s â”€â”€â†’ 10s â”€â”€â†’ 20s â”€â”€â†’ 30s â”€â”€â†’ 40s â”€â”€â†’ 50s â”€â”€â†’ 60s
    ğŸ’¡    ğŸ’¡     ğŸ’¡     ğŸ’¡     ğŸ¯å®Œæ•´   ğŸ’¡     ğŸ’¡

å„ªå‹¢ï¼šæŒçºŒå›é¥‹æ„Ÿï¼Œç”¨æˆ¶çŸ¥é“ App åœ¨å·¥ä½œ
```

---

## âš¡ èƒ½å¦ç¸®çŸ­è¼•é‡ç´šé–“éš”ï¼Ÿ

### å•é¡Œï¼šèƒ½å¦å¾ 10 ç§’ç¸®çŸ­åˆ° 5 ç§’ï¼Ÿ

**æŠ€è¡“å¯è¡Œæ€§**:
- âœ… **Rule-based**: å¯ä»¥ï¼ï¼ˆ<10msï¼Œéš¨æ™‚å¯èª¿ç”¨ï¼‰
- âš ï¸ **Gemini Light**: ä¸å»ºè­°ï¼ˆ1-2 ç§’ï¼Œå¤ªé »ç¹æœƒå¢åŠ æˆæœ¬ï¼‰

**å»ºè­°é–“éš”**:
```
Rule-based è¼•é‡æç¤º:
- æœ€çŸ­é–“éš”: 5 ç§’ï¼ˆæŠ€è¡“å¯è¡Œï¼‰
- æ¨è–¦é–“éš”: 10 ç§’ï¼ˆé«”é©—æœ€ä½³ï¼‰
- ç†ç”±: å¤ªçŸ­æœƒ"æ´—ç‰ˆ"ï¼Œç”¨æˆ¶ä¾†ä¸åŠçœ‹

Gemini é‡åº¦åˆ†æ:
- æœ€çŸ­é–“éš”: 15 ç§’ï¼ˆå—é™æ–¼ 2.5-5s è™•ç†æ™‚é–“ï¼‰
- æ¨è–¦é–“éš”: 40-60 ç§’ï¼ˆåŸºæ–¼ safety_level å‹•æ…‹èª¿æ•´ï¼‰
- ç†ç”±: éœ€è¦è¶³å¤ çš„å°è©±å…§å®¹æ‰èƒ½åˆ†æ
```

**æ¥µé™æ¸¬è©¦**:
| é–“éš” | æŠ€è¡“å¯è¡Œ | é«”é©—å¥½ | æˆæœ¬ | æ¨è–¦ |
|------|---------|--------|------|------|
| 5 ç§’ | âœ… | âš ï¸ æ´—ç‰ˆ | $0 | âŒ |
| **10 ç§’** | âœ… | âœ… | $0 | âœ… **æ¨è–¦** |
| 15 ç§’ | âœ… | âœ… | $0 | âœ… |
| 20 ç§’ | âœ… | ğŸŸ¡ ç¨æ…¢ | $0 | ğŸŸ¡ |

---

## ğŸ¯ æœ€çµ‚å»ºè­°ï¼ˆåŸºæ–¼çœŸå¯¦æ¸¬è©¦ï¼‰

### æ–¹æ¡ˆï¼šRule-based è¼•é‡ï¼ˆ10sï¼‰+ Gemini é‡åº¦ï¼ˆ90s å‹•æ…‹ï¼‰

**ç‚ºä»€éº¼é¸ Rule-basedï¼Ÿ**
1. âœ… **é€Ÿåº¦æ¥µå¿«**ï¼ˆ<10msï¼‰â†’ å¯ä»¥åšåˆ° 10 ç§’ç”šè‡³æ›´çŸ­
2. âœ… **æˆæœ¬ç‚ºé›¶** â†’ ä¸å¢åŠ ä»»ä½•æˆæœ¬
3. âœ… **å¯é æ€§é«˜** â†’ ä¸ä¾è³´ç¶²è·¯ï¼Œä¸æœƒå¤±æ•—
4. âœ… **å·²è¶³å¤ ** â†’ é…åˆå±éšªé—œéµå­—æª¢æ¸¬ï¼Œå®‰å…¨æ€§æœ‰ä¿éšœ

**ç‚ºä»€éº¼ä¸é¸ Gemini Lightï¼Ÿ**
1. âš ï¸ **é€Ÿåº¦æœ‰é™**ï¼ˆ1.74s å¯¦æ¸¬ï¼‰â†’ æ¯” Rule-based æ…¢ 174 å€
2. âš ï¸ **å¢åŠ æˆæœ¬**ï¼ˆ+11%ï¼‰â†’ åƒ¹å€¼ä¸å¤ å¤§
3. âš ï¸ **ä¾è³´ç¶²è·¯** â†’ å¯èƒ½å¤±æ•—ï¼Œå½±éŸ¿é«”é©—

**ç‚ºä»€éº¼é‡åº¦åˆ†æè¦ 90 ç§’é–“éš”ï¼Ÿ**
1. âš ï¸ **åŸ·è¡Œæ™‚é–“é•·**ï¼ˆ16.78s å¯¦æ¸¬ï¼‰â†’ 60 ç§’é–“éš”å¤ªç·Šå¼µ
2. âš ï¸ **é¿å…é‡ç–Š**ï¼ˆ90s - 17s = 73s ç·©è¡ï¼‰â†’ ç¢ºä¿ä¸æœƒåŒæ™‚åŸ·è¡Œå¤šå€‹åˆ†æ
3. âœ… **æˆæœ¬ä¸å¢åŠ **ï¼ˆ90s é–“éš” = 40 æ¬¡/h = ç•¶å‰æˆæœ¬ï¼‰â†’ é›¶æˆæœ¬å¢åŠ 

**å¯¦ä½œå„ªå…ˆç´š**:
1. ğŸ”´ **P0**: Rule-based è¼•é‡æç¤ºï¼ˆ10 ç§’é–“éš”ï¼‰
2. ğŸ”´ **P0**: èª¿æ•´é‡åº¦åˆ†æé–“éš”ç‚º **90 ç§’**ï¼ˆåŸºæ–¼å¯¦æ¸¬é€Ÿåº¦ï¼‰
3. ğŸŸ¡ **P1**: å‹•æ…‹èª¿æ•´æ©Ÿåˆ¶ï¼ˆåŸºæ–¼ safety_level: 60s/90s/120sï¼‰
4. ğŸŸ¢ **P2**: å¯é¸çš„ Gemini Light æ¨¡å¼ï¼ˆç”¨æˆ¶å¯é–‹é—œï¼‰
5. ğŸŸ¢ **P3**: æ€§èƒ½å„ªåŒ–ï¼ˆä¸¦è¡Œè™•ç†ã€ç•°æ­¥ GBQã€ç·©å­˜ï¼‰â†’ ç›®æ¨™ 12-14s

---

## ğŸ“‹ å¯¦ä½œ Checklist

æ•´åˆé€²ä»»å‹™ 1ï¼š

- [ ] 1.6.1 å±éšªé—œéµå­—é…ç½®ï¼ˆapp/config/danger_keywords.pyï¼‰
- [ ] 1.6.2 é¼“å‹µå¥åº«ï¼ˆapp/data/encouragements.jsonï¼‰
  - ç¶ ç‡ˆé¼“å‹µå¥ Ã— 30
  - é»ƒç‡ˆæé†’å¥ Ã— 30
  - ç´…ç‡ˆè§¸ç™¼å¥ Ã— 5
- [ ] 1.6.3 Rule-based åˆ†æå™¨ï¼ˆapp/services/rule_based_analyzer.pyï¼‰
- [ ] 1.6.4 æ™ºèƒ½èª¿åº¦å™¨ï¼ˆapp/services/analysis_scheduler.pyï¼‰
  - è¼•é‡/é‡åº¦äº¤æ›¿é‚è¼¯
  - å‹•æ…‹é–“éš”èª¿æ•´
- [ ] 1.6.5 API æ•´åˆï¼ˆanalyze-partial å¢åŠ  scheduling_modeï¼‰
- [ ] 1.6.6 Integration tests

**é ä¼°æ™‚é–“**: +2 å°æ™‚ï¼ˆåŠ å…¥ä»»å‹™ 1ï¼Œç¸½æ™‚é–“ 6-8h â†’ 8-10hï¼‰

---

**çµè«–**: è¼•é‡ç´šå¯ä»¥ç¸®çŸ­åˆ° **10 ç§’**ï¼ˆæ¨è–¦ï¼‰æˆ– **5 ç§’**ï¼ˆæ¥µé™ï¼‰ï¼Œä½¿ç”¨ Rule-based æ–¹æ¡ˆå³å¯é”æˆï¼ğŸš€

---

## ğŸ“Š çœŸå¯¦æ¸¬è©¦ç¸½çµï¼ˆ2025-12-31 - 5 æ¬¡å¹³å‡ï¼‰

### é—œéµç™¼ç¾

1. **ç”¨æˆ¶é«”é©—å®Œå…¨æ­£ç¢º** âœ…
   - ç”¨æˆ¶å ±å‘Š: ~15 ç§’
   - å¯¦æ¸¬å¾Œç«¯: **10.24 ç§’å¹³å‡**
   - åŠ ä¸Šç¶²è·¯ + å‰ç«¯: 13-15 ç§’ â† å®Œå…¨å»åˆï¼

2. **Gemini API å°±æ˜¯ä¸»è¦ç“¶é ¸** ğŸ”´
   - Gemini API: 8.50s (83% å¾Œç«¯æ™‚é–“)
   - RAG æª¢ç´¢: 1.74s (17% å¾Œç«¯æ™‚é–“)
   - **è®Šç•°æ¥µå¤§**: 4.18s - 13.57s (å·® 3 å€)

3. **é‡åº¦åˆ†æé–“éš”éœ€è¦èª¿æ•´** ğŸ”´
   - åŸå»ºè­°: 40-60 ç§’
   - å¯¦æ¸¬èª¿æ•´: **60-90 ç§’**ï¼ˆåŸºæ–¼ 10.24s å¹³å‡ + è®Šç•°æ€§ï¼‰
   - ç†ç”±: Gemini å¯èƒ½éœ€è¦ 13sï¼Œéœ€è¦ç·©è¡é¿å…é‡ç–Š

### æœ€çµ‚æ¨è–¦æ–¹æ¡ˆ

```
æ™‚é–“è»¸: 0s â”€â”€â†’ 10s â”€â”€â†’ 20s â”€â”€â†’ ... â”€â”€â†’ 90s â”€â”€â†’ 100s â”€â”€â†’ ...
        â”œ Rule  â”œ Rule  â”œ Rule       â”œ Heavy â”€â”€ (åŸ·è¡Œ 17s) â”€â”€ â”¤
        è¼•é‡    è¼•é‡    è¼•é‡          é‡åº¦åˆ†æ                   è¼•é‡

æˆæœ¬: $0.26/æ¬¡ Ã— 40æ¬¡/å°æ™‚ = $10.40/å°æ™‚ (èˆ‡ç•¶å‰ç›¸åŒ)
é«”é©—: æ¯ 10 ç§’æŒçºŒå›é¥‹ (vs ç•¶å‰ 90 ç§’æ‰ 1 æ¬¡)
```

### æ¸¬è©¦è…³æœ¬

- **å®Œæ•´ç«¯åˆ°ç«¯æ¸¬è©¦**: `scripts/test_real_api_e2e.py`
- **Gemini API æ¸¬è©¦**: `scripts/test_real_gemini_speed.py`
- **è¼•é‡ vs é‡é‡å°æ¯”**: `scripts/test_light_vs_heavy_analysis.py`

### ä¸‹ä¸€æ­¥

1. âœ… æ–‡æª”å·²æ›´æ–° (æ­¤æ–‡ä»¶)
2. ğŸ”´ å¯¦ä½œ Rule-based è¼•é‡æç¤º (P0)
3. ğŸ”´ èª¿æ•´é‡åº¦åˆ†æé–“éš”ç‚º 90 ç§’ (P0)
4. ğŸŸ¡ å¯¦ä½œå‹•æ…‹èª¿æ•´æ©Ÿåˆ¶ (P1)
5. ğŸŸ¢ æ€§èƒ½å„ªåŒ– (P3) - ç›®æ¨™å¾ 17s å„ªåŒ–åˆ° 12-14s
