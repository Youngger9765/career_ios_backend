# 週報 - 2025/10/27 - 2025/11/02

## 📊 本週完成項目

### 1. 報告編輯功能：支援 Markdown 格式 ⭐⭐⭐⭐⭐

**功能說明**：
- 諮詢師可以直接在 iOS App 編輯報告內容
- 使用 Markdown 格式，方便排版和格式化
- 系統自動保留 AI 原始報告和編輯後版本

**對案主的價值**：
- ✅ 諮詢師可快速調整報告內容
- ✅ 支援即時預覽
- ✅ 編輯歷史完整保留

**技術實作**：
- 新增 `content_markdown` 和 `edited_content_markdown` 欄位
- 報告生成時同時產生 JSON 和 Markdown 兩種格式
- iOS 可直接渲染 Markdown，無需複雜解析

---

### 2. 效能優化：消除冷啟動延遲 ⚡️

**問題背景**：
- 舊版：API 首次請求需要 10-20 秒冷啟動
- 影響：使用者體驗不佳，以為系統當機

**解決方案**：
- 設定 Cloud Run `min-instances=1`
- 保持至少一個實例永遠運行
- **結果**：首次請求從 20 秒降至 < 2 秒 ⚡️

**成本影響**：
- 增加約 $8-10/月（保持一個實例運行）
- 但大幅提升使用者體驗

---

### 3. 報告 Markdown 直接更新 API

**功能說明**：
- 前端可直接傳送 Markdown 內容更新報告
- 無需處理複雜的 JSON 結構

**API 端點**：
```
PATCH /api/v1/reports/{id}
{
  "edited_content_markdown": "# 修改後的報告內容..."
}
```

**對 iOS 開發者的價值**：
- ✅ 簡化前端實作
- ✅ 減少資料格式轉換
- ✅ 提高開發效率

---

### 4. Gemini File Search 評估報告

**研究目標**：
評估是否應該從 OpenAI + Supabase 切換到 Google Gemini File Search

**結論**：
- ❌ **不建議完全取代**
- ✅ 但可考慮混合使用

**原因**：
1. ✅ Gemini File Search 更簡單、成本更低
2. ❌ 但 OpenAI GPT-4 品質更高、中文處理更好
3. ✅ 現有系統已穩定運作，有完整測試

**建議**：
- 保持現有 OpenAI RAG 系統
- 未來可評估 Gemini 2.5 Pro 中文能力
- 分析完整報告：`GEMINI_RAG_ANALYSIS.md`

---

## 📈 系統狀態

### 部署環境
- **Staging URL**: https://career-app-api-staging-kxaznpplqq-uc.a.run.app
- **狀態**: ✅ 正常運作
- **冷啟動時間**: < 2 秒（已優化）

### 本週測試
- ✅ 報告 Markdown 編輯功能
- ✅ 冷啟動效能測試
- ✅ API 回應時間測試

---

## 🎯 下週計畫

1. **多租戶架構設計** - 支援職游和浮島兩個品牌
2. **動態欄位配置** - 不同組織可自訂 Client/Case 欄位
3. **RLS 安全機制** - 資料庫層級的租戶隔離

---

**週報日期**: 2025-11-02
**系統版本**: v0.1.0
**主要貢獻者**: Development Team
