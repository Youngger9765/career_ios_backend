# é€±å ± - 2026/02/03 - 2026/02/07

> **æœ¬é€±ç‹€æ…‹**: âœ… å®Œæˆ
> **å·¥ä½œé‡é»**: URL æ­£è¦åŒ–ï¼ˆFirebase Hostingï¼‰ã€App Store å¯©æ ¸æº–å‚™ã€å¯†ç¢¼è¦å‰‡ç°¡åŒ–ã€Email é©—è­‰ä¿®å¾©

---

## ğŸ“Š æœ¬é€±å®Œæˆé …ç›®

### 1. URL æ­£è¦åŒ– - Firebase Hosting åå‘ä»£ç† â­â­â­â­â­

**å·¥ä½œå…§å®¹**ï¼š
ä½¿ç”¨ Firebase Hosting ä½œç‚ºåå‘ä»£ç†ï¼Œéš±è— Cloud Run å…§éƒ¨ URLï¼Œçµ±ä¸€å“ç‰Œå½¢è±¡ï¼Œç‚ºå¤šç§Ÿæˆ¶æ“´å±•åšæº–å‚™ã€‚

#### æ¶æ§‹è¨­è¨ˆ

**ç‚ºä»€éº¼éœ€è¦ Firebase Hostingï¼Ÿ**
- âŒ Cloud Run URL éé•·ä¸”æš´éœ²å…§éƒ¨è³‡è¨Šï¼š`career-app-api-prod-xxx.us-central1.run.app`
- âœ… Firebase Hosting æä¾›ç°¡æ½”å“ç‰Œ URLï¼š`island-parents-app.web.app`
- âœ… æ¯å€‹ Firebase å°ˆæ¡ˆå¯å»ºç«‹ 36 å€‹ Hosting sitesï¼ˆå¤šç§Ÿæˆ¶å‹å–„ï¼‰
- âœ… Free Tierï¼š10GB/month æµé‡

**URL å°æ‡‰è¡¨**

| ç’°å¢ƒ | Firebase Hosting URL | Cloud Run Backend |
|------|---------------------|-------------------|
| PROD | https://island-parents-app.web.app | career-app-api-prod |
| Staging | https://island-parents-staging.web.app | career-app-api-staging |
| Backup | https://groovy-iris-473015-h3.web.app | career-app-api-prod |

#### æŠ€è¡“å¯¦ä½œ

**Firebase Hosting é…ç½®**
```json
{
  "hosting": {
    "site": "island-parents-app",
    "rewrites": [
      {
        "source": "**",
        "run": {
          "serviceId": "career-app-api-prod",
          "region": "us-central1"
        }
      }
    ]
  }
}
```

**Staging ç’°å¢ƒ**
```bash
472f1b3 feat: add staging Firebase Hosting site (island-parents-staging)
```

**PROD ç’°å¢ƒ**
```bash
7d7fa75 feat: add Firebase Hosting as reverse proxy to Cloud Run
```

#### GitHub Secrets æ›´æ–°

```
PROD_APP_URL = https://island-parents-app.web.app
APP_URL = https://island-parents-staging.web.app
```

#### E2E é©—è­‰

**PROD ç’°å¢ƒ**
- âœ… https://island-parents-app.web.app â†’ æ­£ç¢ºä»£ç†è‡³ Cloud Run PROD
- âœ… API ç«¯é»æ­£å¸¸å›æ‡‰
- âœ… Terms/Privacy é é¢æ­£å¸¸é¡¯ç¤º

**Staging ç’°å¢ƒ**
- âœ… https://island-parents-staging.web.app â†’ æ­£ç¢ºä»£ç†è‡³ Cloud Run Staging
- âœ… API ç«¯é»æ­£å¸¸å›æ‡‰
- âœ… æ‰€æœ‰åŠŸèƒ½æ­£å¸¸é‹ä½œ

#### æ¥­å‹™åƒ¹å€¼

- âœ… **å“ç‰Œçµ±ä¸€** - ä½¿ç”¨ `island-parents-app.web.app` å–ä»£å†—é•· Cloud Run URL
- âœ… **å®‰å…¨æ€§** - éš±è— Cloud Run å…§éƒ¨æœå‹™åç¨±èˆ‡å€åŸŸè³‡è¨Š
- âœ… **å¤šç§Ÿæˆ¶å°±ç·’** - æ¯å€‹ç§Ÿæˆ¶å¯æœ‰ç¨ç«‹çš„ Firebase Hosting site
- âœ… **æˆæœ¬å‹å–„** - Firebase Hosting Free Tier 10GB/month
- âœ… **iOS ç«¯ç°¡åŒ–** - Base URL æ›´çŸ­æ›´æ˜“ç®¡ç†

#### iOS ç«¯å¾…è¾¦

> iOS ç«¯éœ€åˆ‡æ› Base URLï¼Œè©³è¦‹ [iOS Guide - Base URL é…ç½®](https://github.com/Youngger9765/career_ios_backend/blob/main/IOS_GUIDE_PARENTS.md#161-base-url-é…ç½®)

---

### 2. Apple Review å¸³è™Ÿæº–å‚™ â­â­â­â­

**å·¥ä½œå…§å®¹**ï¼š
å»ºç«‹ Apple å¯©æ ¸å°ˆç”¨å¸³è™Ÿï¼Œç¢ºä¿ PROD å’Œ Staging ç’°å¢ƒéƒ½å¯æ­£å¸¸ç™»å…¥ï¼Œç‚º App Store é€å¯©åšæº–å‚™ã€‚

#### å¸³è™Ÿè³‡è¨Š

```
Email:    apple_review@islandparents.app
Password: Island2026
Tenant:   island_parents
```

#### å¯¦ä½œå…§å®¹

**Seed Script æ–°å¢**
```bash
c85945e chore: add Apple review account for island_parents tenant
```

**å¯†ç¢¼æ›´æ–°**
```bash
7c50f36 chore: change Apple review account password to Island2026
```

#### ç’°å¢ƒé©—è­‰

| ç’°å¢ƒ | URL | ç‹€æ…‹ |
|------|-----|------|
| PROD | https://island-parents-app.web.app | âœ… å¯ç™»å…¥ |
| Staging | https://island-parents-staging.web.app | âœ… å¯ç™»å…¥ |

#### æ–‡æª”æ›´æ–°

```bash
47a480d docs: add Apple review account info to iOS guide (v1.12)
```

- âœ… æ›´æ–° `IOS_GUIDE_PARENTS.md` è‡³ v1.12
- âœ… æ–°å¢ Apple å¯©æ ¸å¸³è™Ÿè³‡è¨Šå€å¡Š
- âœ… åŒ…å«å¸³è™Ÿã€å¯†ç¢¼ã€å¯ç”¨ç’°å¢ƒ

---

### 3. å¯†ç¢¼è¦å‰‡ç°¡åŒ– â­â­â­â­

**å·¥ä½œå…§å®¹**ï¼š
ç°¡åŒ–å¯†ç¢¼å¼·åº¦è¦æ±‚ï¼Œç§»é™¤å¤§å¯«å­—æ¯å’Œç‰¹æ®Šå­—å…ƒçš„å¼·åˆ¶è¦å®šï¼Œé™ä½ç”¨æˆ¶è¨»å†Šé–€æª»ã€‚

```bash
f38d727 feat: simplify password rules to letter+digit, min 8 chars
```

#### è¦å‰‡è®Šæ›´

**Beforeï¼ˆåš´æ ¼ï¼‰**
```
- è‡³å°‘ 8 å­—å…ƒ
- å¿…é ˆåŒ…å«å¤§å¯«å­—æ¯
- å¿…é ˆåŒ…å«å°å¯«å­—æ¯
- å¿…é ˆåŒ…å«æ•¸å­—
- å¿…é ˆåŒ…å«ç‰¹æ®Šå­—å…ƒ
```

**Afterï¼ˆç°¡åŒ–ï¼‰**
```
- è‡³å°‘ 8 å­—å…ƒ
- è‡³å°‘ä¸€å€‹è‹±æ–‡å­—æ¯ (a-z / A-Z)
- è‡³å°‘ä¸€å€‹æ•¸å­— (0-9)
```

#### æŠ€è¡“å¯¦ä½œ

**é©—è­‰é‚è¼¯**
```python
def validate_password(password: str) -> bool:
    if len(password) < 8:
        return False
    if not re.search(r'[a-zA-Z]', password):
        return False
    if not re.search(r'[0-9]', password):
        return False
    return True
```

**éŒ¯èª¤å›æ‡‰æ ¼å¼ï¼ˆRFC 7807ï¼‰**
```json
{
  "detail": "å¯†ç¢¼ä¸ç¬¦åˆè¦å‰‡",
  "password_rules": {
    "min_length": 8,
    "require_letter": true,
    "require_digit": true,
    "require_uppercase": false,
    "require_special": false
  }
}
```

#### æ¸¬è©¦è¦†è“‹

**4 å€‹æ¸¬è©¦å ´æ™¯**
1. âœ… åˆè¦å¯†ç¢¼ï¼ˆå¦‚ `Test1234`ï¼‰
2. âœ… éçŸ­å¯†ç¢¼ï¼ˆå¦‚ `Ab1`ï¼‰â†’ 422
3. âœ… ç¼ºå°‘å­—æ¯ï¼ˆå¦‚ `12345678`ï¼‰â†’ 422
4. âœ… ç¼ºå°‘æ•¸å­—ï¼ˆå¦‚ `abcdefgh`ï¼‰â†’ 422

#### æ–‡æª”æ›´æ–°

```bash
e936cd4 docs: add password_rules field table and fix verify-email docs
```

- âœ… æ›´æ–° API æ–‡æª”ä¸­çš„ `password_rules` æ¬„ä½èªªæ˜

---

### 4. Email é©—è­‰ 404 ä¿®å¾© â­â­â­â­

**å·¥ä½œå…§å®¹**ï¼š
ä¿®å¾© Email é©—è­‰é€£çµé»æ“Šå¾Œè¿”å› 404 çš„å•é¡Œï¼Œæ–°å¢ GET è·¯ç”±è™•ç†ç€è¦½å™¨ç›´æ¥è¨ªå•ã€‚

```bash
bd08369 fix: add GET /{tenant}/verify-email route for email verification link
```

#### å•é¡Œåˆ†æ

**Root Cause**
```
ç”¨æˆ¶æ”¶åˆ° email â†’ é»æ“Šé©—è­‰é€£çµ
                      â†“
              ç€è¦½å™¨ç™¼é€ GET è«‹æ±‚
                      â†“
              ä¼ºæœå™¨åªæœ‰ POST è·¯ç”±
                      â†“
                  404 Not Found âŒ
```

#### ä¿®å¾©æ–¹æ¡ˆ

**æ–°å¢ GET è·¯ç”±**
```python
@app.get("/{tenant}/verify-email")
async def verify_email_get(
    tenant: str,
    token: str = Query(...),
):
    """è™•ç† Email é©—è­‰é€£çµï¼ˆGET è«‹æ±‚ï¼‰"""
    # é©—è­‰ token
    result = verify_email_token(token)

    if result.success:
        return HTMLResponse("""
            <h1>Email é©—è­‰æˆåŠŸ</h1>
            <p>æ‚¨çš„å¸³è™Ÿå·²é©—è­‰ï¼Œè«‹è¿”å› App ç™»å…¥ã€‚</p>
        """)
    else:
        return HTMLResponse("""
            <h1>é©—è­‰å¤±æ•—</h1>
            <p>é€£çµå·²éæœŸæˆ–ç„¡æ•ˆï¼Œè«‹é‡æ–°ç”³è«‹ã€‚</p>
        """, status_code=400)
```

#### E2E é©—è­‰æµç¨‹

```
1. è¨»å†Šæ–°å¸³è™Ÿ â†’ âœ…
2. æ”¶åˆ°é©—è­‰ Email â†’ âœ…
3. é»æ“Šé©—è­‰é€£çµ â†’ âœ…
4. é¡¯ç¤º HTML çµæœé é¢ â†’ âœ…ï¼ˆå–ä»£ 404ï¼‰
5. å¸³è™Ÿç‹€æ…‹æ›´æ–°ç‚ºå·²é©—è­‰ â†’ âœ…
```

---

### 5. Production DB è¨­å®š â­â­â­

**å·¥ä½œå…§å®¹**ï¼š
è‡¨æ™‚è¨­å®š PROD ç’°å¢ƒå…±ç”¨ Staging çš„ Supabase DBï¼Œç¢ºä¿ PROD ç’°å¢ƒå¯æ­£å¸¸é‹ä½œã€‚

```bash
a9df981 chore: configure PROD DB to share staging DB (temporary)
```

#### è¨­å®šå…§å®¹

**GitHub Secrets æ›´æ–°**
```
PROD_DATABASE_URL = (same as staging Supabase URL)
```

**æ³¨æ„äº‹é …**
- âš ï¸ é€™æ˜¯è‡¨æ™‚æ–¹æ¡ˆï¼ŒPROD å’Œ Staging å…±ç”¨åŒä¸€å€‹ DB
- âš ï¸ éœ€è¦åœ¨ 1-2 é€±å…§æ‰¾åˆ°ç¨ç«‹çš„ Staging DB
- âœ… Apple å¯©æ ¸æœŸé–“ PROD éœ€è¦å¯é‹ä½œçš„ DB

#### å¾…è¾¦

- ğŸ”„ æ‰¾æ–°çš„ Staging DBï¼ˆ1-2 é€±å…§ï¼‰
- ğŸ”„ PROD å’Œ Staging DB å®Œå…¨åˆ†é›¢

---

### 6. ä»£ç¢¼æ¸…ç† â­â­â­

**å·¥ä½œå…§å®¹**ï¼š
ç§»é™¤æœªä½¿ç”¨çš„æœå‹™æ¨¡çµ„ï¼Œæ¸›å°‘ä»£ç¢¼åº«é«”ç©èˆ‡ç¶­è­·è² æ“”ã€‚

```bash
26e7d9b chore: remove unused Whisper STT and Codeer LLM services
```

#### ç§»é™¤å…§å®¹

| æœå‹™ | èªªæ˜ | åŸå›  |
|------|------|------|
| Whisper STT | èªéŸ³è½‰æ–‡å­—æœå‹™ | åŠŸèƒ½æœªä½¿ç”¨ï¼Œæ”¹ç”¨å…¶ä»–æ–¹æ¡ˆ |
| Codeer LLM | LLM æ•´åˆæœå‹™ | å·²è¢« Gemini å–ä»£ |

**æ•ˆæœ**
- âœ… æ¸›å°‘æœªä½¿ç”¨çš„ç¨‹å¼ç¢¼
- âœ… é™ä½ä¾è³´è¤‡é›œåº¦
- âœ… æ¸›å°‘æ½›åœ¨çš„å®‰å…¨é¢¨éšª

---

## ğŸ“ˆ æœ¬é€±çµ±è¨ˆ

### ç¨‹å¼ç¢¼è®Šæ›´
```
10 commits
feat: 3 | fix: 1 | chore: 4 | docs: 2
```

### åˆ†é¡çµ±è¨ˆ

| é¡åˆ¥ | Commits | èªªæ˜ |
|------|---------|------|
| Firebase Hosting | 2 | PROD + Staging åå‘ä»£ç† |
| Apple Review | 2 | å¯©æ ¸å¸³è™Ÿå»ºç«‹èˆ‡å¯†ç¢¼æ›´æ–° |
| å¯†ç¢¼è¦å‰‡ | 1 | ç°¡åŒ–å¯†ç¢¼å¼·åº¦è¦æ±‚ |
| Email é©—è­‰ | 1 | GET è·¯ç”±ä¿®å¾© 404 |
| DB è¨­å®š | 1 | PROD å…±ç”¨ Staging DB |
| ä»£ç¢¼æ¸…ç† | 1 | ç§»é™¤ Whisper/Codeer |
| æ–‡æª” | 2 | å¯†ç¢¼è¦å‰‡æ–‡æª”ã€iOS Guide v1.12 |

---

## ğŸš€ éƒ¨ç½²ç‹€æ…‹

### ç’°å¢ƒé©—è­‰

| ç’°å¢ƒ | URL | ç‹€æ…‹ |
|------|-----|------|
| PROD | https://island-parents-app.web.app | âœ… æ­£å¸¸ |
| Staging | https://island-parents-staging.web.app | âœ… æ­£å¸¸ |
| Backup | https://groovy-iris-473015-h3.web.app | âœ… æ­£å¸¸ |

### Key URLs

- **PROD**: https://island-parents-app.web.app
- **Staging**: https://island-parents-staging.web.app
- **iOS Guide**: [IOS_GUIDE_PARENTS.md](https://github.com/Youngger9765/career_ios_backend/blob/main/IOS_GUIDE_PARENTS.md)
- **Base URL é…ç½®**: [Section 16.1](https://github.com/Youngger9765/career_ios_backend/blob/main/IOS_GUIDE_PARENTS.md#161-base-url-é…ç½®)

---

## ğŸ¯ å¾…è¾¦äº‹é …

### iOS ç«¯å¾…è¾¦ï¼ˆå¾… iOS é–‹ç™¼ï¼‰

- ğŸ”„ åˆ‡æ› Base URL è‡³ Firebase Hosting URL
  - PROD: `https://island-parents-app.web.app`
  - Staging: `https://island-parents-staging.web.app`
  - è©³è¦‹ [iOS Guide - Base URL é…ç½®](https://github.com/Youngger9765/career_ios_backend/blob/main/IOS_GUIDE_PARENTS.md#161-base-url-é…ç½®)

### Backend å¾…è¾¦

- ğŸ”„ æ‰¾æ–°çš„ Staging DBï¼ˆ1-2 é€±å…§ï¼‰
  - ç›®å‰ PROD å’Œ Staging å…±ç”¨åŒä¸€å€‹ Supabase DB
  - éœ€è¦ç¨ç«‹çš„ Staging DB é¿å…è³‡æ–™äº’ç›¸å½±éŸ¿

---

## ğŸ’¡ æŠ€è¡“æ´å¯Ÿ

### Firebase Hosting as Reverse Proxy

**æ¨¡å¼**: Firebase Hosting â†’ Cloud Run

**å„ªå‹¢**
- âœ… å…è²» CDNï¼ˆå…¨çƒé‚Šç·£ç¯€é»ï¼‰
- âœ… è‡ªå‹• SSL æ†‘è­‰
- âœ… ç°¡æ½” URLï¼ˆ`.web.app` ç¶²åŸŸï¼‰
- âœ… å¤š site æ”¯æ´ï¼ˆæ¯å°ˆæ¡ˆ 36 å€‹ï¼‰
- âœ… é›¶åœæ©Ÿéƒ¨ç½²

**é™åˆ¶**
- âš ï¸ Free Tier 10GB/month æµé‡
- âš ï¸ ç„¡æ³•è‡ªè¨‚ HTTP headersï¼ˆéœ€åœ¨ Cloud Run è™•ç†ï¼‰
- âš ï¸ ä¸æ”¯æ´ WebSocketï¼ˆå¦‚éœ€è¦å‰‡ç›´é€£ Cloud Runï¼‰

**é©ç”¨å ´æ™¯**
- âœ… API åå‘ä»£ç†
- âœ… éœæ…‹é é¢è¨—ç®¡ï¼ˆTerms/Privacyï¼‰
- âœ… å¤šç§Ÿæˆ¶ URL ç®¡ç†
- âŒ å³æ™‚é€šè¨Šï¼ˆWebSocketï¼‰

### å¯†ç¢¼è¦å‰‡è¨­è¨ˆåŸå‰‡

**NIST 800-63B å»ºè­°**
- âœ… æœ€ä½ 8 å­—å…ƒ
- âœ… ä¸å¼·åˆ¶è¤‡é›œåº¦è¦å‰‡ï¼ˆå¤§å¯«ã€ç‰¹æ®Šå­—å…ƒï¼‰
- âœ… æä¾›æ˜ç¢ºçš„è¦å‰‡èªªæ˜ï¼ˆ`password_rules` dictï¼‰
- âŒ ä¸ä½¿ç”¨å®šæœŸå¼·åˆ¶æ›´æ›

**ç”¨æˆ¶é«”é©—å„ªå…ˆ**
- é™ä½è¨»å†Šé–€æª» â†’ æå‡è½‰æ›ç‡
- æ˜ç¢ºçš„éŒ¯èª¤æç¤º â†’ æ¸›å°‘ç”¨æˆ¶æŒ«æŠ˜æ„Ÿ
- RFC 7807 éŒ¯èª¤æ ¼å¼ â†’ å‰ç«¯å®¹æ˜“è§£æ

---

**å ±å‘Šæ™‚é–“**: 2026-02-07
**å ±å‘Šäºº**: AI Assistant (Claude Code)
**ä¸‹æ¬¡å ±å‘Š**: 2026-02-14

---

Co-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>
