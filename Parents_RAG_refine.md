# Parents Realtime åˆ†æç³»çµ±æ”¹é€²è¨ˆåŠƒ

## æ–‡ä»¶ç›®çš„

è¨˜éŒ„ Realtime è¦ªå­å°è©±åˆ†æç³»çµ±çš„å•é¡Œè¨ºæ–·ã€æ”¹é€²æ–¹æ¡ˆå’Œå¯¦ä½œé€²åº¦ã€‚
éµå¾ª **PDCAï¼ˆPlan-Do-Check-Actï¼‰** å¾ªç’°ï¼ŒæŒçºŒå„ªåŒ–ç³»çµ±æ•ˆæœã€‚

---

## ğŸ“‹ Planï¼ˆç¾æ³åˆ†æèˆ‡æ”¹é€²è¨ˆåŠƒï¼‰

### å•é¡Œå®šç¾©

**ä¾†æº**ï¼š12/18 æ™šä¸Š nini è€å¸«ä½¿ç”¨ APP å¾Œçš„åé¥‹
> "è€å¸«å›é¥‹ä»–çµ¦çš„å»ºè­°åŸºæœ¬ä¸Šç”¨ä¸å¤ªåˆ°ï¼Œèˆ‡å¯¦éš›æƒ…æ³æœ‰å·®ç•°"

**æ ¹æœ¬åŸå› åˆ†æ**ï¼ˆapp/api/realtime.pyï¼‰ï¼š

1. **åˆ†æç¯„åœå¤ªçª„**ï¼ˆæœ€é—œéµï¼‰
   - Line 49-52: åªåˆ†æã€Œæœ€æ–°ä¸€åˆ†é˜ã€å°è©±
   - å¿½ç•¥é‡è¦ä¸Šä¸‹æ–‡ï¼Œå°è‡´å»ºè­°è„«é›¢å¯¦éš›æƒ…æ³

2. **Practice æ¨¡å¼å»ºè­°å¤ªé•·**
   - Line 67-68: `< 50 å­—`
   - æ‡‰è©²ï¼š`â‰¤ 15 å­—`ï¼ˆåƒå°ˆå®¶å»ºè­°ä¸€æ¨£ç°¡çŸ­ï¼‰

3. **LLM è‡ªå·±ç”Ÿæˆå»ºè­°**
   - ä¸ç©©å®šã€å¤ªé•·ã€ä¸å¤ å°ˆæ¥­
   - æ‡‰è©²ï¼šå¾ 200 å¥å°ˆå®¶å»ºè­°ä¸­é¸æ“‡

4. **ç¼ºå°‘ Bridge æŠ€å·§**
   - ç¾æœ‰ç³»çµ±åå‘ã€Œè©•åƒ¹ã€
   - ç¼ºå°‘ã€Œé€£çµã€å’Œã€Œç©©å®šã€æ©Ÿåˆ¶

5. **é¢¨éšªè©•ä¼°å¤ªç²—ç³™**
   - Line 294-345: åªç”¨é—œéµå­—åŒ¹é…
   - "ä½ è®“æˆ‘å—ä¸äº†" vs "é€™å€‹éŠæˆ²è®“æˆ‘å—ä¸äº†" éƒ½èª¤åˆ¤ç‚º RED

6. **RAG æª¢ç´¢ä¸è¶³**
   - Line 688-699: top_k=3, å…§å®¹æˆªæ–· 200 å­—
   - æª¢ç´¢åˆ°çš„çŸ¥è­˜å¤ªå°‘

7. **è§’è‰²æ··æ·†**
   - ç³»çµ±å‡è¨­ï¼šcounselor â†’ parent (client)
   - 12/18 å¯¦éš›ï¼šteacher â†’ child
   - éœ€è¦è§’è‰²è‡ªé©æ‡‰

---

### æ ¸å¿ƒæ”¹é€²æ–¹å‘

#### 1. å°ˆå®¶å»ºè­°ç³»çµ±ï¼ˆ200 å¥å³æ™‚å›é¥‹ï¼‰

è¦ªå­æºé€šå°ˆå®¶æä¾›çš„ **200 å¥å³æ™‚å›é¥‹å»ºè­°**ï¼Œç”¨ä¸‰è‰²ç‡ˆè™Ÿåˆ†é¡ï¼š

##### ğŸŸ¢ ç¶ è‰²ï½œå°è©±å®‰å…¨ï¼ˆ70 å¥ï¼‰
**ç›®çš„**ï¼šå¼·åŒ–æ­£å‘è¡Œç‚ºï¼Œèªªæ˜æœ‰æ•ˆæºé€šçš„é—œéµ

**æ ¸å¿ƒåŸå‰‡**ï¼š
- æ¥ä½æƒ…ç·’ï¼šå…ˆç†è§£æ„Ÿå—ï¼Œä¸æ€¥è‘—è§£æ±ºå•é¡Œ
- å»ºç«‹ä¿¡ä»»ï¼šè®“å­©å­çŸ¥é“ä½ ç«™åœ¨ä»–é€™é‚Š
- å°Šé‡ç†è§£ï¼šæŠŠå­©å­ç•¶æˆä¸€å€‹äººï¼Œä¸æ˜¯å•é¡Œ

**å…¸å‹å»ºè­°å¥**ï¼ˆæ¯å¥ â‰¤ 15 å­—ï¼‰ï¼š
```
- è®“å­©å­çŸ¥é“ä½ ç«™åœ¨ä»–é€™é‚Š (12å­—)
- ä½ å…ˆç†è§£æ„Ÿå—ï¼Œè€Œä¸æ˜¯è™•ç†äº‹æƒ… (14å­—)
- ä½ çš„èªæ°£è®“å­©å­æ„Ÿåˆ°è¢«å°Šé‡ (12å­—)
- ä½ æ²’æœ‰æ€¥è‘—çµ¦ç­”æ¡ˆ (8å­—)
- ä½ åœ¨é™ªï¼Œè€Œä¸æ˜¯æ¨ (7å­—)
```

##### ğŸŸ  æ©˜è‰²ï½œéœ€è¦èª¿æ•´ï¼ˆ65 å¥ï¼‰
**ç›®çš„**ï¼šæŒ‡å‡ºå¯æ”¹å–„é»ï¼Œæä¾›æ›¿ä»£èªªæ³•

**è­¦è¨ŠæŒ‡æ¨™**ï¼š
- é–‹å§‹èªªç†ï¼šå¤ªå¿«é€²å…¥è§£é‡‹ã€è¬›é“ç†
- æƒ…ç·’å¤±ç„¦ï¼šå­©å­çš„æ„Ÿå—é‚„æ²’è¢«æ¥ä½
- ç«™åˆ°å°ç«‹ï¼šé–‹å§‹è©•åƒ¹ã€è¦æ±‚ã€æ¯”è¼ƒ

**å…¸å‹å»ºè­°å¥**ï¼š
```
- é€™å¥è©±å¯èƒ½è®“å­©å­é–‹å§‹é˜²è¡› (13å­—)
- ä½ æœ‰é»å¤ªå¿«é€²å…¥èªªç† (9å­—)
- å­©å­çš„æ„Ÿå—é‚„æ²’è¢«æ¥ä½ (10å­—)
- ä½ é–‹å§‹åœ¨è§£é‡‹è‡ªå·±äº† (9å­—)
```

##### ğŸ”´ ç´…è‰²ï½œç«‹åˆ»ä¿®æ­£ï¼ˆ65 å¥ï¼‰
**ç›®çš„**ï¼šè­¦å‘Šå±å®³ï¼Œæä¾›ç·Šæ€¥ä¿®æ­£æ–¹æ¡ˆ

**å±éšªè¡Œç‚º**ï¼š
- ç›´æ¥å‚·å®³ï¼šè²¼æ¨™ç±¤ã€å¨è„…ã€ç¾è¾±
- æƒ…ç·’æš´åŠ›ï¼šæƒ…ç·’å‹’ç´¢ã€å†·æš´åŠ›
- ç ´å£é—œä¿‚ï¼šå¦å®šå­˜åœ¨ã€åˆ‡æ–·é€£çµ

**å…¸å‹å»ºè­°å¥**ï¼š
```
- é€™å¥è©±æœƒç›´æ¥å‚·åˆ°å­©å­ (10å­—)
- ä½ æ­£åœ¨ç”¨æŒ‡è²¬çš„æ–¹å¼èªªè©± (11å­—)
- é€™æ˜¯å¨è„…æ€§çš„èªæ°£ (8å­—)
- è«‹ç«‹åˆ»åœä¸‹ä¾† (6å­—)
```

---

#### 2. Bridge æŠ€å·§ï¼ˆç„¦é»è§£æ±ºå–å‘ï¼‰

**ä¾†æº**ï¼šSolomon Chen å°ˆå®¶è«®è©¢ï¼ˆ2025-12-25 23:32ï¼‰

**æ ¸å¿ƒç†å¿µ**ï¼š
> ç”¨é¼“å‹µå’Œé€£çµçš„è©±èªï¼ŒæŠŠå®¶é•·å¾ã€Œæˆ‘è¢«å•é¡Œå›°ä½äº†ã€å¸¶åˆ°ã€Œæˆ‘æ›¾ç¶“æˆåŠŸéï¼Œæˆ‘å¯ä»¥åšäº›ä»€éº¼ã€

**ä¸‰æ­¥é©Ÿæ¶æ§‹**ï¼š

1. **è®šç¾ï¼ˆComplimentsï¼‰**
   - è‚¯å®šéå»åŠªåŠ›å’Œåšå¾—å¥½çš„åœ°æ–¹
   - ç¯„ä¾‹ï¼šã€Œä½ é¡˜æ„åæ€è‡ªå·±çš„è¡Œç‚ºï¼Œé€™å·²ç¶“æ˜¯å¾ˆå¤§çš„é€²æ­¥äº†ã€

2. **æ©‹æ¨‘ï¼ˆBridgeï¼‰**
   - ç”¨æå•é€£çµéå»æˆåŠŸç¶“é©—
   - ç¯„ä¾‹ï¼šã€Œä½ ä¹‹å‰æœ‰æ²’æœ‰å“ªæ¬¡æˆåŠŸå£“ä½æƒ…ç·’çš„ç¶“é©—ï¼Ÿç•¶æ™‚ä½ åšäº†ä»€éº¼ï¼Ÿã€

3. **å»ºè­°ä»»å‹™ï¼ˆSuggesting tasksï¼‰**
   - æå‡ºå…·é«”çš„å°ä»»å‹™
   - ç¯„ä¾‹ï¼šã€Œä¸‹æ¬¡é‡åˆ°é¡ä¼¼ç‹€æ³ï¼Œè©¦è‘—å…ˆæ·±å‘¼å¸ä¸‰æ¬¡ï¼Œå†é–‹å£èªªè©±ã€

**æ‡‰ç”¨åˆ°ä¸‰è‰²ç‡ˆè™Ÿ**ï¼š

- **ğŸŸ¢ ç¶ è‰²**ï¼šè®šç¾ â†’ æ©‹æ¨‘ â†’ å»¶ä¼¸
- **ğŸŸ  æ©˜è‰²**ï¼šè‚¯å®š â†’ æé†’ â†’ æ›¿ä»£
- **ğŸ”´ ç´…è‰²**ï¼šç©©ä½ â†’ åŒç† â†’ ä¿®æ­£ï¼ˆæœ€é‡è¦ï¼ï¼‰

**ç´…è‰²ç‡ˆè™Ÿçš„ä¸‰éšæ®µè¨­è¨ˆ**ï¼š
```
1. å…ˆç©©ä½ï¼šã€Œç†è§£åœ¨æ•™é¤Šå£“åŠ›ä¸‹ï¼Œæƒ…ç·’å¤±æ§æ˜¯å¾ˆæ­£å¸¸çš„ã€
2. é™ä½é˜²è¡›ï¼šã€Œä½ ä¸€å®šä¹Ÿå¾ˆè¾›è‹¦ï¼Œæƒ³è¦å­©å­å¥½ä½†ä¸çŸ¥é“æ€éº¼åšã€
3. å†æé†’ï¼šã€Œé€™å¥è©±å¯èƒ½æœƒè®“å­©å­æ„Ÿåˆ°å®³æ€•ï¼Œæˆ‘å€‘å¯ä»¥è©¦è©¦é€™æ¨£èªª...ã€
```

---

### æ”¹é€²ç›®æ¨™

**ç«‹å³ç›®æ¨™**ï¼ˆæœ¬é€±ï¼‰ï¼š
- âœ… **Emergency æ¨¡å¼**ï¼š1-2 å¥ï¼ˆå¾ 200 å¥å°ˆå®¶å»ºè­°ä¸­é¸ï¼‰
- âœ… **Practice æ¨¡å¼**ï¼š3-4 å¥ï¼ˆå¾ 200 å¥å°ˆå®¶å»ºè­°ä¸­é¸ï¼‰
- âœ… å¾ 200 å¥å°ˆå®¶å»ºè­°ä¸­é¸æ“‡ï¼Œä¸è®“ LLM è‡ªå·±ç”Ÿæˆ
- âœ… åŠ å…¥ Bridge æŠ€å·§çµæ§‹
- âœ… å‰ç«¯æ”¹æ‰å…©è¡Œæ ¼å¼åˆ¤æ–·ï¼ˆçµ±ä¸€å–®è¡Œæ ¼å¼ï¼‰
- âœ… å»ºç«‹ GBQ Table ä¸¦å¯¦ä½œéåŒæ­¥å¯«å…¥ï¼ˆWeb ç‰ˆæš«ä¸å¯« DBï¼‰

**çŸ­æœŸç›®æ¨™**ï¼ˆ2 é€±å…§ï¼‰ï¼š
- æ“´å¤§åˆ†æç¯„åœï¼ˆå¾ 1 åˆ†é˜ â†’ 3-5 åˆ†é˜ï¼‰
- æ”¹é€²é¢¨éšªè©•ä¼°é‚è¼¯ï¼ˆä¸Šä¸‹æ–‡ç†è§£ï¼Œéé—œéµå­—åŒ¹é…ï¼‰
- å¢å¼· RAG æª¢ç´¢ï¼ˆtop_k=5-10, ç§»é™¤å…§å®¹æˆªæ–·ï¼‰
- **è¦†ç›¤çµ±æ•´**ï¼šæœƒè«‡çµæŸå¾Œï¼Œä½¿ç”¨ç¾æœ‰ **Report API** ç”Ÿæˆç¸½çµå ±å‘Šï¼ˆä¸éœ€è¦æ–°åŠŸèƒ½ï¼‰

**ä¸åš**ï¼ˆéåº¦å·¥ç¨‹åŒ–ï¼‰ï¼š
- âŒ å‘é‡åŒ– 200 å¥å»ºè­° â†’ Chroma DB
- âŒ Looker Studio Dashboardï¼ˆç¾éšæ®µï¼‰
- âŒ è¤‡é›œçš„ ETL Pipeline
- âŒ è¤‡é›œçš„ Re-rankingã€Hybrid Retrieval
- âŒ A/B Testing æ¡†æ¶ï¼ˆç¾éšæ®µï¼‰
- âŒ è¦†ç›¤çµ±æ•´çš„é¡å¤–æ–°é‚è¼¯ï¼ˆç”¨ç¾æœ‰ Report API å³å¯ï¼‰

---

## ğŸ› ï¸ Doï¼ˆå¯¦ä½œæ–¹æ¡ˆï¼‰

### æ–¹æ¡ˆ 1ï¼šç°¡å–®å„ªå…ˆ - ç›´æ¥æ”¾ Prompt

**âŒ æ‹’çµ•éåº¦å·¥ç¨‹åŒ–**ï¼š
- ä¸å»ºç«‹ç¨ç«‹çš„ Chroma DB Collection
- ä¸åšå‘é‡æœå°‹
- ä¸åšè¤‡é›œçš„ Hybrid Retrieval

**âœ… æ¡ç”¨ç°¡å–®æ–¹æ¡ˆ**ï¼š

#### æ–¹æ³• Aï¼ˆå„ªå…ˆï¼‰ï¼šç›´æ¥åˆ—åœ¨ç³»çµ±æç¤ºè©

```python
CACHE_SYSTEM_INSTRUCTION = """
ä½ æ˜¯è¦ªå­æºé€šåˆ†æåŠ©æ‰‹...

ã€å°ˆå®¶å»ºè­°å¥åº«ã€‘è«‹å¾ä»¥ä¸‹å»ºè­°ä¸­é¸æ“‡ 2-3 å¥æœ€ç¬¦åˆç•¶å‰å°è©±çš„ï¼š

ğŸŸ¢ ç¶ è‰²ï½œå°è©±å®‰å…¨ï¼ˆé¸ 1-2 å¥ï¼‰ï¼š
- è®“å­©å­çŸ¥é“ä½ ç«™åœ¨ä»–é€™é‚Š
- ä½ å…ˆç†è§£æ„Ÿå—ï¼Œè€Œä¸æ˜¯è™•ç†äº‹æƒ…
- ä½ çš„èªæ°£è®“å­©å­æ„Ÿåˆ°è¢«å°Šé‡
- ä½ æ²’æœ‰æ€¥è‘—çµ¦ç­”æ¡ˆ
- ä½ åœ¨é—œå¿ƒäººï¼Œè€Œä¸åªæ˜¯çµæœ
... (å…¨éƒ¨ 70 å¥)

ğŸŸ  æ©˜è‰²ï½œéœ€è¦èª¿æ•´ï¼ˆé¸ 1-2 å¥ï¼‰ï¼š
- é€™å¥è©±å¯èƒ½è®“å­©å­é–‹å§‹é˜²è¡›
- ä½ æœ‰é»å¤ªå¿«é€²å…¥èªªç†
- å­©å­çš„æ„Ÿå—é‚„æ²’è¢«æ¥ä½
- ä½ é–‹å§‹åœ¨è§£é‡‹è‡ªå·±äº†
... (å…¨éƒ¨ 65 å¥)

ğŸ”´ ç´…è‰²ï½œç«‹åˆ»ä¿®æ­£ï¼ˆé¸ 1-2 å¥ï¼‰ï¼š
- é€™å¥è©±æœƒç›´æ¥å‚·åˆ°å­©å­
- ä½ æ­£åœ¨ç”¨æŒ‡è²¬çš„æ–¹å¼èªªè©±
- é€™æ˜¯å¨è„…æ€§çš„èªæ°£
- è«‹ç«‹åˆ»åœä¸‹ä¾†
... (å…¨éƒ¨ 65 å¥)

ã€Bridge æŠ€å·§ã€‘è«‹æŒ‰ç…§ä»¥ä¸‹çµæ§‹çµ„ç¹”å›é¥‹ï¼š

ç¶ è‰²ï¼šè®šç¾ â†’ æ©‹æ¨‘ â†’ å»¶ä¼¸
æ©˜è‰²ï¼šè‚¯å®š â†’ æé†’ â†’ æ›¿ä»£
ç´…è‰²ï¼šç©©ä½ â†’ åŒç† â†’ ä¿®æ­£

ã€åˆ†ææ­¥é©Ÿã€‘ï¼š
1. åˆ¤æ–·å°è©±å®‰å…¨ç­‰ç´šï¼ˆgreen/orange/redï¼‰
2. å¾å°æ‡‰é¡è‰²çš„å»ºè­°å¥ä¸­é¸å‡º 2-3 å¥æœ€ç¬¦åˆçš„
3. ä½¿ç”¨ Bridge æŠ€å·§çµ„ç¹”å›é¥‹
4. æ¯å¥å»ºè­° â‰¤ 15 å­—
"""
```

**ç‚ºä»€éº¼é€™æ¨£å°±å¤ äº†ï¼Ÿ**
- âœ… 200 å¥å»ºè­°ç¸½å…±ç´„ 3000 å­—ï¼ŒToken æˆæœ¬æ¥µä½
- âœ… LLM ç†è§£åŠ›è¶³å¤ ï¼Œä¸éœ€è¦å‘é‡æª¢ç´¢
- âœ… å¯¦ä½œç°¡å–®ï¼Œç¶­è­·å®¹æ˜“
- âœ… å›æ‡‰é€Ÿåº¦å¿«ï¼ˆçœå»å‘é‡æª¢ç´¢æ™‚é–“ï¼‰
- âœ… å¯ç›´æ¥åˆ©ç”¨ Gemini Context Cachingï¼ˆ7200s TTLï¼‰

#### æ–¹æ³• Bï¼ˆå‚™æ¡ˆï¼‰ï¼šå¦‚æœ Prompt è¶…é Token é™åˆ¶

```python
# app/config/parenting_suggestions.py
GREEN_SUGGESTIONS = [
    "è®“å­©å­çŸ¥é“ä½ ç«™åœ¨ä»–é€™é‚Š",
    "ä½ å…ˆç†è§£æ„Ÿå—ï¼Œè€Œä¸æ˜¯è™•ç†äº‹æƒ…",
    # ... 70 å¥
]

ORANGE_SUGGESTIONS = [...]
RED_SUGGESTIONS = [...]

# åœ¨ realtime.py ä¸­å‹•æ…‹çµ„åˆ
def build_prompt_with_suggestions(safety_level: str) -> str:
    if safety_level == "green":
        suggestions = GREEN_SUGGESTIONS
    elif safety_level == "orange":
        suggestions = ORANGE_SUGGESTIONS
    else:
        suggestions = RED_SUGGESTIONS

    suggestions_text = "\n- ".join(suggestions)
    return f"ã€{safety_level.upper()} å»ºè­°å¥åº«ã€‘ï¼š\n- {suggestions_text}"
```

---

### æ–¹æ¡ˆ 2ï¼šè³‡æ–™æŒä¹…åŒ–ï¼ˆPostgreSQL + GBQï¼‰

#### è³‡æ–™æ¨¡å‹ï¼ˆç¾æœ‰ Schemaï¼‰

**æ ¸å¿ƒé—œä¿‚**ï¼š
```
Counselor â†’ Client â†’ Case â†’ Session

ä¸€å€‹ Counselor æœ‰å¤šå€‹ Client
ä¸€å€‹ Client æœ‰å¤šå€‹ Caseï¼ˆä¸åŒè«®å•†ä¸»é¡Œï¼‰
ä¸€å€‹ Case æœ‰å¤šå€‹ Sessionï¼ˆæœƒè«‡è¨˜éŒ„ï¼‰
```

**è¦ªå­å°è©±çš„å¯¦ä½œ**ï¼ˆä½¿ç”¨ç¾æœ‰ Schemaï¼‰ï¼š
- **Tenant**: "æµ®å³¶è¦ªå­"ï¼ˆå·²å­˜åœ¨ï¼‰
- **Counselor**: å®¶é•·ï¼ˆåœ¨æµ®å³¶è¦ªå­ tenant ä¸‹ï¼‰
- **Client**: å­©å­
- **Case**: è¦ªå­å°è©±æ¡ˆä¾‹
- **Session**: è¦ªå­å°è©±è¨˜éŒ„
  - `session_type` å¯ç”¨ç¾æœ‰æ¬„ä½å€åˆ†ï¼ˆæœªä¾†å¯æ“´å±•ï¼‰
  - `analysis_logs` å­˜ Realtime åˆ†æçµæœ

**æœªä¾†æ“´å±•**ï¼ˆæš«ä¸å¯¦ä½œï¼‰ï¼š
- Schema èª¿æ•´ï¼ˆcounselor_type, client_type, session_typeï¼‰
- å¤šç§Ÿæˆ¶è¦ªå­å°è©±ç’°å¢ƒ

#### ç•¶å‰ç¾ç‹€

**âœ… DB çµæ§‹å·²æº–å‚™å¥½**ï¼š
- `Session.analysis_logs`ï¼ˆJSON æ¬„ä½ï¼‰å·²å­˜åœ¨æ–¼ `app/models/session.py`

**âŒ Realtime API å°šæœªå¯¦ä½œå¯«å…¥é‚è¼¯**ï¼š
- `app/api/realtime.py` åªåšå³æ™‚åˆ†æä¸¦å›å‚³ JSON
- æ²’æœ‰ `db.add()` æˆ– `.commit()` ç¨‹å¼ç¢¼

#### å¯¦ä½œè¨ˆåŠƒï¼ˆç°¡å–®å„ªå…ˆï¼‰

**âœ… PostgreSQL - å¿…åš**

```python
# Session.analysis_logs æ¬„ä½æ ¼å¼
{
  "analyzed_at": "2025-12-25T23:45:00Z",
  "analysis_type": "practice",             # emergency | practice
  "safety_level": "orange",                # green | orange | red
  "matched_suggestions": [
    "é€™å¥è©±å¯èƒ½è®“å­©å­é–‹å§‹é˜²è¡›",
    "ä½ æœ‰é»å¤ªå¿«é€²å…¥èªªç†"
  ],
  "counselor_id": "uuid-xxx"
}
```

**ç”¨é€”**ï¼š
- è«®è©¢å¸«æŸ¥çœ‹æ­·å²åˆ†æè¨˜éŒ„
- è¿½è¹¤å°è©±å“è³ªè¶¨å‹¢ï¼ˆç¶ â†’æ©˜â†’ç´…ï¼‰
- èˆ‡ Session/Case é—œè¯æŸ¥è©¢

**âœ… GBQ - å¿…åšï¼ˆç°¡å–®ç‰ˆï¼‰**

```sql
-- Table: realtime_analysis_logs
CREATE TABLE realtime_analysis_logs (
  id STRING,
  tenant_id STRING,
  session_id STRING,
  counselor_id STRING,
  analyzed_at TIMESTAMP,
  analysis_type STRING,              -- emergency | practice
  safety_level STRING,               -- green | orange | red
  matched_suggestions ARRAY<STRING>,
  transcript_segment STRING,
  response_time_ms INT64,            -- API å›æ‡‰æ™‚é–“ï¼ˆæ¯«ç§’ï¼‰
  created_at TIMESTAMP
)
PARTITION BY DATE(analyzed_at)
CLUSTER BY tenant_id, safety_level;
```

**ç”¨é€”**ï¼š
- è·¨ç§Ÿæˆ¶åˆ†æï¼šå“ªäº›å»ºè­°æœ€æœ‰æ•ˆï¼Ÿ
- ç‡ˆè™Ÿåˆ†ä½ˆçµ±è¨ˆï¼šç¶ /æ©˜/ç´…æ¯”ä¾‹
- é•·æœŸè¶¨å‹¢åˆ†æï¼šå°è©±å“è³ªæ”¹å–„æƒ…æ³
- ç³»çµ±æ•ˆèƒ½ç›£æ§ï¼šå›æ‡‰æ™‚é–“ã€ä½¿ç”¨é‡

**è³‡æ–™æµ**ï¼š
```
Realtime API åˆ†æå®Œæˆ
    â†“
1. å›å‚³ JSON çµ¦å‰ç«¯ï¼ˆå³æ™‚ï¼‰
    â†“
2. å¯«å…¥ PostgreSQLï¼ˆåŒæ­¥ï¼Œ< 50msï¼‰
    â†“
3. èƒŒæ™¯ä»»å‹™ï¼šéåŒæ­¥å¯«å…¥ GBQ
```

---

### å¯¦ä½œæ­¥é©Ÿ

#### Phase 1ï¼ˆç«‹å³åš - Web ç‰ˆæœ¬å„ªå…ˆï¼‰

##### 1.1 å»ºç«‹ 200 å¥å»ºè­°æª”æ¡ˆ

- [x] **å»ºç«‹æª”æ¡ˆ**ï¼š`app/config/parenting_suggestions.py`
  - [x] GREEN_SUGGESTIONS = [...]  # 70 å¥
  - [x] ORANGE_SUGGESTIONS = [...]  # 65 å¥
  - [x] RED_SUGGESTIONS = [...]  # 65 å¥
  - [x] æ ¼å¼ï¼šç°¡å–®çš„ Python listï¼ˆä¸è¦ TypedDictï¼‰
  - [x] é©—è­‰é€šéï¼ˆ200 å¥ï¼Œç„¡é‡è¤‡ï¼‰

##### 1.2 ä¿®æ”¹å¾Œç«¯ APIï¼ˆ`app/api/realtime.py`ï¼‰

- [ ] **ä¿®æ”¹ Emergency Mode Prompt**
  - [ ] å¾ 200 å¥å°ˆå®¶å»ºè­°ä¸­é¸ 1-2 å¥
  - [ ] ç§»é™¤å…©è¡Œæ ¼å¼ï¼ˆå¿ƒæ³•\nåšæ³•ï¼‰
  - [ ] åŠ å…¥ Bridge æŠ€å·§çµæ§‹ï¼ˆç©©ä½ â†’ åŒç† â†’ ä¿®æ­£ï¼‰

- [ ] **ä¿®æ”¹ Practice Mode Prompt**
  - [ ] å¾ 200 å¥å°ˆå®¶å»ºè­°ä¸­é¸ 3-4 å¥
  - [ ] åŠ å…¥ Bridge æŠ€å·§çµæ§‹ï¼ˆè®šç¾ â†’ æ©‹æ¨‘ â†’ å»¶ä¼¸ï¼‰
  - [ ] åŠ å…¥ 200 å¥å»ºè­°åˆ° CACHE_SYSTEM_INSTRUCTION

- [ ] **æ”¹é€²ç‡ˆè™Ÿåˆ¤æ–·é‚è¼¯**
  - [ ] æ”¹é€² `_assess_risk_level()`
  - [ ] åŠ å…¥ä¸Šä¸‹æ–‡ç†è§£ï¼ˆä¸åªé—œéµå­—åŒ¹é…ï¼‰
  - [ ] æ˜ç¢ºå›å‚³ safety_levelï¼ˆgreen/orange/redï¼‰

- [ ] **æ“´å…… API å›å‚³æ ¼å¼**
  - [ ] æ–°å¢ `"safety_level": "green|orange|red"`
  - [ ] ç¢ºä¿ suggestions å¾ 200 å¥ä¸­é¸æ“‡
  - [ ] æ¸¬è©¦ Emergency æ¨¡å¼ï¼š1-2 å¥
  - [ ] æ¸¬è©¦ Practice æ¨¡å¼ï¼š3-4 å¥

##### 1.3 è³‡æ–™æŒä¹…åŒ–ï¼ˆGBQ Only - Web ç‰ˆæš«ä¸å¯« DBï¼‰

**æ±ºç­–**ï¼š
- âœ… **GBQ å¯«å…¥**ï¼ˆå¿…åšï¼‰ï¼šè¨˜éŒ„æ‰€æœ‰åˆ†æçµæœï¼Œç”¨æ–¼é•·æœŸåˆ†æ
- âŒ **PostgreSQL å¯«å…¥**ï¼ˆWeb ç‰ˆæš«ä¸åšï¼‰ï¼šWeb ç„¡ session æ¦‚å¿µï¼Œç­‰ iOS ç‰ˆå†å¯¦ä½œ
- ğŸ·ï¸ **tenant_id å›ºå®š**ï¼š`"island_parents"`ï¼ˆæµ®å³¶è¦ªå­ï¼‰

- [ ] **å»ºç«‹ GBQ Table Schema**
  - [ ] Table åç¨±ï¼š`realtime_analysis_logs`
  - [ ] æ¬„ä½è¨­è¨ˆï¼š
    ```sql
    CREATE TABLE realtime_analysis_logs (
      id STRING,                          -- UUID
      tenant_id STRING,                   -- å›ºå®š "island_parents"
      session_id STRING,                  -- Web ç‰ˆç‚º nullï¼ŒiOS ç‰ˆæœ‰å€¼
      analyzed_at TIMESTAMP,              -- åˆ†ææ™‚é–“
      analysis_type STRING,               -- "emergency" | "practice"
      safety_level STRING,                -- "green" | "orange" | "red"
      matched_suggestions ARRAY<STRING>,  -- é¸ä¸­çš„å°ˆå®¶å»ºè­°
      transcript_segment STRING,          -- è¢«åˆ†æçš„é€å­—ç¨¿ç‰‡æ®µ
      response_time_ms INT64,             -- API å›æ‡‰æ™‚é–“ï¼ˆæ¯«ç§’ï¼‰
      created_at TIMESTAMP                -- è¨˜éŒ„å»ºç«‹æ™‚é–“
    )
    PARTITION BY DATE(analyzed_at)
    CLUSTER BY tenant_id, safety_level;
    ```

- [ ] **å¯¦ä½œ GBQ å¯«å…¥ï¼ˆéåŒæ­¥ï¼‰**
  - [ ] åœ¨ `realtime.py` åŠ å…¥ GBQ å¯«å…¥é‚è¼¯
  - [ ] ä½¿ç”¨ `asyncio.create_task()` æˆ– FastAPI BackgroundTasks
  - [ ] è³‡æ–™æ ¼å¼ï¼š
    ```python
    {
      "id": str(uuid.uuid4()),
      "tenant_id": "island_parents",      # å›ºå®š
      "session_id": None,                 # Web ç‰ˆç‚º None
      "analyzed_at": datetime.utcnow(),
      "analysis_type": "emergency|practice",
      "safety_level": "green|orange|red",
      "matched_suggestions": [...],
      "transcript_segment": "...",
      "response_time_ms": 1500,
      "created_at": datetime.utcnow()
    }
    ```

- [ ] **éŒ¯èª¤è™•ç†**
  - [ ] GBQ å¯«å…¥å¤±æ•—ä¸å½±éŸ¿ API å›æ‡‰ï¼ˆcatch exceptionï¼‰
  - [ ] è¨˜éŒ„éŒ¯èª¤åˆ° loggingï¼ˆä¸è¦ silent failï¼‰
  - [ ] å¦‚æœ GBQ unavailableï¼ŒAPI ä»ç„¶æ­£å¸¸å›å‚³

- [ ] **æ¸¬è©¦ GBQ å¯«å…¥**
  - [ ] æ¸¬è©¦è³‡æ–™æˆåŠŸå¯«å…¥ GBQ
  - [ ] æ¸¬è©¦éåŒæ­¥åŸ·è¡Œä¸é˜»å¡ API å›æ‡‰
  - [ ] æ¸¬è©¦éŒ¯èª¤è™•ç†ï¼ˆGBQ å¯«å…¥å¤±æ•—æ™‚ï¼‰

##### 1.4 å‰ç«¯èª¿æ•´ï¼ˆ`app/templates/realtime_counseling.html`ï¼‰

- [ ] **ç§»é™¤å…©è¡Œæ ¼å¼åˆ¤æ–·**
  - [ ] ç§»é™¤ Line 2533-2542 çš„ `if (sug.includes('\n'))` åˆ¤æ–·
  - [ ] çµ±ä¸€ä½¿ç”¨å–®è¡Œæ ¼å¼é¡¯ç¤º

- [ ] **å¡ç‰‡è¦–è¦ºåæ‡‰ï¼ˆæ ¹æ“šç‡ˆè™Ÿï¼‰**
  - [ ] ğŸŸ¢ **ç¶ ç‡ˆå¡ç‰‡**ï¼š`bg-green-50 border-green-200 text-green-700`
  - [ ] ğŸŸ  **é»ƒç‡ˆå¡ç‰‡**ï¼š`bg-yellow-50 border-yellow-200 text-yellow-700`
  - [ ] ğŸ”´ **ç´…ç‡ˆå¡ç‰‡**ï¼š`bg-red-50 border-red-200 text-red-700`
  - [ ] å¯¦ä½œé‚è¼¯ï¼š
    ```javascript
    // æ ¹æ“š API å›å‚³çš„ safety_level å‹•æ…‹è¨­å®šå¡ç‰‡æ¨£å¼
    const cardStyles = {
      green: 'bg-green-50 border-2 border-green-200 text-green-700',
      orange: 'bg-yellow-50 border-2 border-yellow-200 text-yellow-700',
      red: 'bg-red-50 border-2 border-red-200 text-red-700'
    };
    ```

- [ ] **æ›´æ–°å‰ç«¯èªªæ˜**
  - [ ] Line 404: æ”¹æˆã€Œå¯¦æˆ°ï¼šæ¥µç°¡å»ºè­°ï¼ˆ1-2 å¥ï¼‰ã€
  - [ ] Line 720: æ”¹æˆã€Œå¯¦æˆ°ï¼šæ¥µç°¡å»ºè­°ï¼ˆ1-2 å¥ï¼‰ã€
  - [ ] Line 405, 721: æ”¹æˆã€Œç·´ç¿’ï¼šå®Œæ•´åˆ†æï¼ˆ3-4 å¥ï¼‰ã€

- [ ] **æ¸¬è©¦å‰ç«¯é¡¯ç¤º**
  - [ ] Emergency æ¨¡å¼ï¼šé¡¯ç¤º 1-2 å€‹å¤§å¡ç‰‡
  - [ ] Practice æ¨¡å¼ï¼šé¡¯ç¤º 3-4 å€‹å¤§å¡ç‰‡
  - [ ] ç¢ºèªå¤§å­—é¡¯ç¤ºæ­£å¸¸ï¼ˆtext-xl md:text-2xlï¼‰
  - [ ] ç¢ºèªç‡ˆè™Ÿé¡è‰²æ­£ç¢ºï¼ˆç¶ /é»ƒ/ç´…ï¼‰

##### 1.5 æ¸¬è©¦

- [ ] **Integration Tests**
  - [ ] æ¸¬è©¦ Emergency mode API
    - [ ] å›å‚³ 1-2 å¥å»ºè­°
    - [ ] åŒ…å« safety_level
    - [ ] å»ºè­°å¾ 200 å¥ä¸­é¸æ“‡
  - [ ] æ¸¬è©¦ Practice mode API
    - [ ] å›å‚³ 3-4 å¥å»ºè­°
    - [ ] åŒ…å« safety_level
    - [ ] å»ºè­°å¾ 200 å¥ä¸­é¸æ“‡
  - [ ] æ¸¬è©¦ GBQ å¯«å…¥
    - [ ] è³‡æ–™æˆåŠŸå¯«å…¥
    - [ ] éåŒæ­¥åŸ·è¡Œä¸å½±éŸ¿ API å›æ‡‰
    - [ ] tenant_id ç‚º "island_parents"

- [ ] **æ‰‹å‹•æ¸¬è©¦**
  - [ ] ç”¨ 12/18 è€å¸«çš„å¯¦éš›å°è©±æ¸¬è©¦
  - [ ] é©—è­‰å»ºè­°æ˜¯å¦å¯¦ç”¨
  - [ ] ç¢ºèªç‡ˆè™Ÿåˆ¤æ–·åˆç†

#### Phase 2ï¼ˆæœ¬é€±å…§ï¼‰

##### 2.1 å¾Œç«¯å„ªåŒ–

- [ ] **æ“´å¤§åˆ†æç¯„åœ**
  - å¾ã€Œæœ€æ–° 1 åˆ†é˜ã€â†’ã€Œæœ€è¿‘ 3-5 åˆ†é˜ã€
  - ä¿ç•™å®Œæ•´å°è©±ä¸Šä¸‹æ–‡

- [ ] **å¢å¼· RAG æª¢ç´¢**
  - top_k: 3 â†’ 5-10
  - similarity_threshold: 0.5 â†’ 0.3-0.4
  - ç§»é™¤ 200 å­—å…§å®¹æˆªæ–·

##### 2.2 å‰ç«¯æ™ºèƒ½åŒ–

- [ ] **å‹•æ…‹èª¿æ•´åˆ†æé »ç‡ï¼ˆæ ¹æ“šç‡ˆè™Ÿï¼‰**
  - [ ] ğŸŸ¢ **ç¶ ç‡ˆ**ï¼ˆå°è©±å®‰å…¨ï¼‰ï¼š60 ç§’è§¸ç™¼ä¸€æ¬¡
    - ç•¶å‰ç‹€æ…‹è‰¯å¥½ï¼Œç¶­æŒæ­£å¸¸ç›£æ§é »ç‡
  - [ ] ğŸŸ  **æ©˜ç‡ˆ**ï¼ˆéœ€è¦èª¿æ•´ï¼‰ï¼š30 ç§’è§¸ç™¼ä¸€æ¬¡
    - å°è©±å‡ºç¾è­¦è¨Šï¼Œæé«˜ç›£æ§å¯†åº¦
  - [ ] ğŸ”´ **ç´…ç‡ˆ**ï¼ˆç«‹åˆ»ä¿®æ­£ï¼‰ï¼š15 ç§’è§¸ç™¼ä¸€æ¬¡
    - å±éšªç‹€æ³ï¼Œæœ€é«˜ç›£æ§é »ç‡
  - [ ] å¯¦ä½œé‚è¼¯ï¼š
    ```javascript
    // æ ¹æ“šä¸Šæ¬¡åˆ†æçš„ safety_level å‹•æ…‹èª¿æ•´
    let analysisInterval = 60; // é è¨­
    if (lastSafetyLevel === 'red') analysisInterval = 15;
    else if (lastSafetyLevel === 'orange') analysisInterval = 30;
    else analysisInterval = 60;

    // Line 2036: æ”¹æˆå‹•æ…‹åˆ¤æ–·
    if (elapsed > 0 && elapsed % analysisInterval === 0) {
        analyzeTranscript();
    }
    ```
  - [ ] å‰ç«¯é¡¯ç¤ºå€’æ•¸è¨ˆæ™‚ï¼ˆä¸‹æ¬¡åˆ†æé‚„æœ‰ X ç§’ï¼‰
  - [ ] ç‡ˆè™Ÿè®ŠåŒ–æ™‚å³æ™‚èª¿æ•´é–“éš”

- [ ] **å¡ç‰‡å»é‡é‚è¼¯ï¼ˆé¿å…é‡è¤‡å»ºè­°ï¼‰**
  - [ ] å•é¡Œï¼š60 ç§’å…§å°è©±æ²’è®ŠåŒ– â†’ æ”¶åˆ°ç›¸åŒå»ºè­°å¡ç‰‡
  - [ ] è§£æ±ºæ–¹æ¡ˆï¼šæ¯”è¼ƒæ–°èˆŠå¡ç‰‡å…§å®¹ç›¸ä¼¼åº¦
    ```javascript
    // è¨ˆç®—å…©å¥å»ºè­°çš„ç›¸ä¼¼åº¦ï¼ˆç°¡å–®æ–¹å¼ï¼šLevenshtein distance or å­—ä¸²æ¯”å°ï¼‰
    function isSimilarSuggestion(newSug, oldSug) {
      // æ–¹æ³• 1ï¼šå®Œå…¨ç›¸åŒ
      if (newSug === oldSug) return true;

      // æ–¹æ³• 2ï¼šç›¸ä¼¼åº¦ > 80%ï¼ˆä½¿ç”¨ç°¡å–®å­—ä¸²æ¯”å°ï¼‰
      const similarity = calculateSimilarity(newSug, oldSug);
      return similarity > 0.8;
    }

    // éæ¿¾é‡è¤‡å»ºè­°
    const newSuggestions = apiResponse.suggestions.filter(newSug => {
      return !lastSuggestions.some(oldSug => isSimilarSuggestion(newSug, oldSug));
    });

    // å¦‚æœæ²’æœ‰æ–°å»ºè­°ï¼Œä¿ç•™èˆŠå¡ç‰‡ï¼ˆä¸æ›´æ–°ï¼‰
    if (newSuggestions.length === 0) {
      console.log('å»ºè­°å…§å®¹èˆ‡ä¸Šæ¬¡ç›¸åŒï¼Œä¿ç•™åŸå¡ç‰‡');
      return;
    }
    ```
  - [ ] å¯¦ä½œç´°ç¯€ï¼š
    - [ ] å„²å­˜ä¸Šæ¬¡çš„å»ºè­°å…§å®¹ï¼ˆ`lastSuggestions = []`ï¼‰
    - [ ] æ¯æ¬¡ API å›å‚³å¾Œæ¯”å°æ–°èˆŠå»ºè­°
    - [ ] ç›¸ä¼¼åº¦ > 80% è¦–ç‚ºé‡è¤‡
    - [ ] åªé¡¯ç¤ºæ–°çš„ã€ä¸é‡è¤‡çš„å»ºè­°
    - [ ] å¦‚æœå®Œå…¨æ²’æœ‰æ–°å»ºè­°ï¼Œä¿ç•™åŸå¡ç‰‡ä¸è®Š
  - [ ] æ¸¬è©¦å ´æ™¯ï¼š
    - [ ] å°è©±æŒçºŒé€²è¡Œ â†’ æ–°å»ºè­°æ­£å¸¸é¡¯ç¤º
    - [ ] å°è©±åœé “/ç„¡è®ŠåŒ– â†’ ä¸é¡¯ç¤ºé‡è¤‡å»ºè­°
    - [ ] 60 ç§’å¾Œå°è©±æ”¹è®Š â†’ é¡¯ç¤ºæ–°å»ºè­°

##### 2.3 æ¸¬è©¦

- [ ] **Integration Tests**
  - æ¸¬è©¦ Practice mode å»ºè­°å¾ 200 å¥ä¸­é¸æ“‡
  - æ¸¬è©¦ç‡ˆè™Ÿåˆ¤æ–·æ­£ç¢ºæ€§
  - æ¸¬è©¦ GBQ å¯«å…¥
  - æ¸¬è©¦å‹•æ…‹åˆ†æé »ç‡åˆ‡æ›
  - æ¸¬è©¦å¡ç‰‡å»é‡é‚è¼¯

---

## âœ… Checkï¼ˆæª¢æŸ¥è©•ä¼°ï¼‰

### ç°¡å–®è©•ä¼°æŒ‡æ¨™

**ç³»çµ±æ•ˆèƒ½**ï¼š
- å›æ‡‰æ™‚é–“ï¼š< 2 ç§’ï¼ˆPractice modeï¼‰
- å»ºè­°ä¾†æºï¼š100% å¾ 200 å¥å°ˆå®¶å»ºè­°ä¸­é¸æ“‡
- ç‡ˆè™Ÿæ­£ç¢ºç‡ï¼šâ‰¥ 80%ï¼ˆvs å°ˆå®¶æ¨™è¨»ï¼‰

**ä½¿ç”¨è€…é«”é©—**ï¼š
- å»ºè­°ç›¸é—œæ€§ï¼šè€å¸«/å®¶é•·åé¥‹ã€Œæœ‰ç”¨ã€
- å°è©±å“è³ªæ”¹å–„ï¼šç‡ˆè™Ÿè®ŠåŒ–è¶¨å‹¢ï¼ˆç´…â†’æ©˜â†’ç¶ ï¼‰
- å¡ç‰‡å»é‡ï¼šé¿å…é€£çºŒé¡¯ç¤ºç›¸åŒå»ºè­°

### æ¸¬è©¦æ–¹æ³•

1. **äººå·¥æ¸¬è©¦**ï¼ˆç«‹å³ï¼‰
   - ç”¨ 12/18 çš„å¯¦éš›å°è©±æ¸¬è©¦
   - é©—è­‰å»ºè­°æ˜¯å¦ç¬¦åˆæƒ…å¢ƒ

2. **Integration Tests**ï¼ˆæœ¬é€±ï¼‰
   - æ¸¬è©¦ API å›å‚³æ ¼å¼
   - æ¸¬è©¦å»ºè­°é•·åº¦é™åˆ¶
   - æ¸¬è©¦ DB å¯«å…¥

3. **ä½¿ç”¨è€…åé¥‹**ï¼ˆæŒçºŒï¼‰
   - æ”¶é›†è€å¸«/å®¶é•·çš„çœŸå¯¦åé¥‹
   - èª¿æ•´å»ºè­°å¥åº«å’Œ Prompt

---

## ğŸ”„ Actï¼ˆæŒçºŒæ”¹é€²ï¼‰

### å¯¦ä½œæ­·ç¨‹

#### 2025-12-25

**å•é¡Œè¨ºæ–·**ï¼š
- ç™¼ç¾ Realtime API ä¸ƒå¤§å•é¡Œ
- åˆ†æç¯„åœå¤ªçª„æ˜¯æ ¸å¿ƒå•é¡Œ
- LLM è‡ªå·±ç”Ÿæˆå»ºè­°ï¼ˆæ‡‰è©²å¾å°ˆå®¶å»ºè­°ä¸­é¸ï¼‰

**å°ˆå®¶è¼¸å…¥**ï¼š
- æ•´åˆ 200 å¥å°ˆå®¶å»ºè­°ï¼ˆç¶  70 / æ©˜ 65 / ç´… 65ï¼‰
- å¼•å…¥ Bridge æŠ€å·§ï¼ˆç„¦é»è§£æ±ºå–å‘ï¼‰
- é‡æ–°å®šç¾©å›é¥‹æ¶æ§‹ï¼ˆé€£çµ > è©•åƒ¹ï¼‰

**æ±ºç­–**ï¼š
- âœ… ç°¡å–®å„ªå…ˆï¼šç›´æ¥æ”¾ Promptï¼Œä¸ç”¨å‘é‡æœå°‹
- âœ… GBQ æŒä¹…åŒ–ï¼šWeb ç‰ˆåªå¯« GBQï¼ˆtenant_id = "island_parents"ï¼‰
- âœ… ç§»é™¤å­—æ•¸é™åˆ¶ï¼š200 å¥éƒ½èƒ½ç”¨ï¼Œä¸é™åˆ¶å­—æ•¸
- âŒ æ‹’çµ•éåº¦å·¥ç¨‹ï¼šä¸åš Dashboardã€è¤‡é›œ ETLã€A/B Testing

**Phase 1.1 å®Œæˆ**ï¼ˆ2025-12-25ï¼‰ï¼š
- âœ… å»ºç«‹ `app/config/parenting_suggestions.py`
- âœ… å»ºç«‹ `docs/parenting_expert_suggestions.md`
- âœ… å»ºç«‹ `tests/unit/test_parenting_suggestions.py`ï¼ˆ28 å€‹æ¸¬è©¦ï¼‰
- âœ… é©—è­‰é€šéï¼ˆ200 å¥ï¼Œç„¡é‡è¤‡ï¼‰
- âœ… ç§»é™¤å­—æ•¸é™åˆ¶ï¼ˆæ‰€æœ‰å»ºè­°éƒ½å¯ç”¨ï¼‰
- âœ… **æ‰€æœ‰æ¸¬è©¦é€šéï¼ˆ28/28ï¼‰**

### ä¸‹ä¸€æ­¥è¡Œå‹•

**æœ¬é€±ç›®æ¨™**ï¼š
1. âœ… å»ºç«‹ 200 å¥å»ºè­°æª”æ¡ˆï¼ˆå·²å®Œæˆï¼‰
2. ä¿®æ”¹ Emergency/Practice Mode Prompt
3. å»ºç«‹ GBQ Table ä¸¦å¯¦ä½œéåŒæ­¥å¯«å…¥
4. å‰ç«¯èª¿æ•´ï¼ˆå¡ç‰‡é¡è‰²ã€å»é‡é‚è¼¯ï¼‰
5. å¯« Integration Tests

**æˆåŠŸæ¨™æº–**ï¼š
- âœ… 200 å¥å»ºè­°æª”æ¡ˆå»ºç«‹ä¸¦é©—è­‰é€šé
- Emergency/Practice å»ºè­°å¾ 200 å¥ä¸­é¸æ“‡
- åŒ…å« Bridge æŠ€å·§çµæ§‹
- åˆ†æçµæœå­˜å…¥ GBQï¼ˆtenant_id = "island_parents"ï¼‰
- å¡ç‰‡é¡è‰²æ ¹æ“šç‡ˆè™Ÿè®ŠåŒ–ï¼ˆç¶ /é»ƒ/ç´…ï¼‰
- é¿å…é‡è¤‡é¡¯ç¤ºç›¸åŒå»ºè­°

---

## é™„éŒ„

### ç•¶å‰ RAG ç³»çµ±æ¶æ§‹

**å‘é‡è³‡æ–™åº«**ï¼š
- Chroma DBï¼ˆæœ¬åœ°å‘é‡å„²å­˜ï¼‰
- Collection: `parents_knowledge_base`

**åµŒå…¥æ¨¡å‹**ï¼š
- OpenAI `text-embedding-3-small`
- ç¶­åº¦: 1536

**æª¢ç´¢ç­–ç•¥**ï¼š
- ç›¸ä¼¼åº¦æœå°‹ï¼ˆSimilarity Searchï¼‰
- é è¨­æª¢ç´¢æ–‡ä»¶æ•¸: 5

**ç›¸é—œæª”æ¡ˆ**ï¼š
- `/app/services/rag_service.py` - RAG æ ¸å¿ƒé‚è¼¯
- `/app/api/realtime.py` - Realtime åˆ†æ API
- `/app/models/session.py` - Session è³‡æ–™æ¨¡å‹
- `/tests/integration/test_rag_*.py` - RAG æ¸¬è©¦

---

**Note**: æœ¬æ–‡ä»¶ç‚º living documentï¼Œéš¨è‘—ç³»çµ±æ¼”é€²æŒçºŒæ›´æ–°ã€‚æ‰€æœ‰é‡å¤§è®Šæ›´è«‹åŒæ­¥æ›´æ–° CHANGELOG.mdã€‚
