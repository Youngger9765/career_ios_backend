# LLM Provider Comparison - Experiment Workflow

## å¯¦é©—æµç¨‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     EXPERIMENT INITIALIZATION                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Load test data: tests/data/long_transcripts.json            â”‚
â”‚    - 8min: å­©å­ä¸é¡˜æ„åšåŠŸèª² (~1400å­—)                             â”‚
â”‚    - 9min: é’å°‘å¹´å›é€†æœŸå•é¡Œ (~1600å­—)                             â”‚
â”‚    - 10min: æ‰‹è¶³è¡çª (~1800å­—)                                   â”‚
â”‚                                                                 â”‚
â”‚ 2. Apply filters (optional):                                   â”‚
â”‚    - --provider: gemini, codeer, claude, etc.                  â”‚
â”‚    - --duration: 8, 9, 10                                      â”‚
â”‚                                                                 â”‚
â”‚ 3. Initialize test matrix:                                     â”‚
â”‚    [Duration] Ã— [Provider] = Total Tests                       â”‚
â”‚    3 durations Ã— 4 providers = 12 tests (default)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TEST EXECUTION LOOP                         â”‚
â”‚                   (For each duration Ã— provider)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    Provider: Gemini (with cache)    â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ 1. Get or create cache              â”‚
        â”‚    - session_id: experiment-{dur}minâ”‚
        â”‚    - system_instruction (cached)    â”‚
        â”‚    - transcript (cached)            â”‚
        â”‚                                     â”‚
        â”‚ 2. Analyze with cache               â”‚
        â”‚    - gemini_service.analyze_with_   â”‚
        â”‚      cache()                        â”‚
        â”‚                                     â”‚
        â”‚ 3. Extract metadata:                â”‚
        â”‚    - usage_metadata (tokens)        â”‚
        â”‚    - cache_hit (true/false)         â”‚
        â”‚    - latency (ms)                   â”‚
        â”‚                                     â”‚
        â”‚ 4. Calculate cost:                  â”‚
        â”‚    - Input tokens Ã— $0.075/1M       â”‚
        â”‚    - Cached tokens Ã— $0.01875/1M    â”‚
        â”‚    - Output tokens Ã— $0.30/1M       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Provider: Codeer (all 3 models)   â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ For each model:                     â”‚
        â”‚   - claude-sonnet                   â”‚
        â”‚   - gemini-flash                    â”‚
        â”‚   - gpt5-mini                       â”‚
        â”‚                                     â”‚
        â”‚ 1. Get agent ID                     â”‚
        â”‚    - get_codeer_agent_id(model)     â”‚
        â”‚                                     â”‚
        â”‚ 2. Get or create session            â”‚
        â”‚    - session_pool.get_or_create_    â”‚
        â”‚      session()                      â”‚
        â”‚    - Reuse if exists                â”‚
        â”‚                                     â”‚
        â”‚ 3. Send message to agent            â”‚
        â”‚    - client.send_message()          â”‚
        â”‚    - Non-streaming mode             â”‚
        â”‚                                     â”‚
        â”‚ 4. Parse JSON response              â”‚
        â”‚    - Extract from ```json blocks    â”‚
        â”‚    - Validate required fields       â”‚
        â”‚                                     â”‚
        â”‚ 5. Calculate cost (estimated):      â”‚
        â”‚    - API calls Ã— $0.01 per call     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      QUALITY EVALUATION                          â”‚
â”‚                (For each successful test)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Structure Score (20%):                                       â”‚
â”‚    âœ“ Has summary, alerts, suggestions                           â”‚
â”‚    âœ“ All fields have content                                    â”‚
â”‚    âœ“ JSON format valid                                          â”‚
â”‚                                                                 â”‚
â”‚ 2. Relevance Score (30%):                                       â”‚
â”‚    âœ“ Mentions parenting keywords                                â”‚
â”‚    âœ“ Addresses specific issues from transcript                  â”‚
â”‚    âœ“ Provides contextual suggestions                            â”‚
â”‚                                                                 â”‚
â”‚ 3. Professionalism Score (30%):                                 â”‚
â”‚    âœ“ Uses counseling terminology (åŒç†, ç†è§£, å¼•å°)              â”‚
â”‚    âœ“ Avoids judgmental language                                 â”‚
â”‚    âœ“ Empathetic tone                                            â”‚
â”‚    âœ“ Concrete suggestions                                       â”‚
â”‚                                                                 â”‚
â”‚ 4. Completeness Score (20%):                                    â”‚
â”‚    âœ“ Alerts count (ideal: 3-5)                                  â”‚
â”‚    âœ“ Suggestions count (ideal: 2-3)                             â”‚
â”‚    âœ“ Summary length (ideal: 20-100 chars)                       â”‚
â”‚    âœ“ Suggestion length (ideal: < 50 chars)                      â”‚
â”‚                                                                 â”‚
â”‚ Total Quality = Î£(Score Ã— Weight)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RESULTS AGGREGATION                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ For each test, collect:                                         â”‚
â”‚   - provider, model, duration, topic                            â”‚
â”‚   - analysis (summary, alerts, suggestions)                     â”‚
â”‚   - latency_ms                                                  â”‚
â”‚   - cache_hit / session_reused                                  â”‚
â”‚   - usage_metadata / cost_data                                  â”‚
â”‚   - quality_score (total + breakdown)                           â”‚
â”‚   - timestamp                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   RESULTS ANALYSIS & VISUALIZATION               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Table 1: Speed Comparison         â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ Duration â”‚ Gemini â”‚ Codeer Claude â”‚ â”‚
        â”‚          â”‚ (cache)â”‚ Gemini â”‚ GPT-5â”‚ â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤ â”‚
        â”‚  8 min   â”‚ 1234ms â”‚ 2345ms â”‚ ...  â”‚ â”‚
        â”‚  9 min   â”‚ 1456ms â”‚ 2567ms â”‚ ...  â”‚ â”‚
        â”‚ 10 min   â”‚ 1678ms â”‚ 2789ms â”‚ ...  â”‚ â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Table 2: Quality Comparison       â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ Duration â”‚ Gemini â”‚ Codeer Claude â”‚ â”‚
        â”‚          â”‚ (cache)â”‚ Gemini â”‚ GPT-5â”‚ â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤ â”‚
        â”‚  8 min   â”‚ 85.2   â”‚ 88.5   â”‚ ...  â”‚ â”‚
        â”‚  9 min   â”‚ 84.7   â”‚ 89.2   â”‚ ...  â”‚ â”‚
        â”‚ 10 min   â”‚ 86.1   â”‚ 90.1   â”‚ ...  â”‚ â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Table 3: Cost Comparison          â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ Duration â”‚ Gemini  â”‚ Codeer Claudeâ”‚â”‚
        â”‚          â”‚ (cache) â”‚ Gemini â”‚ GPT-5â”‚ â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤ â”‚
        â”‚  8 min   â”‚ $0.0001 â”‚ $0.01  â”‚ ...  â”‚ â”‚
        â”‚  9 min   â”‚ $0.0001 â”‚ $0.01  â”‚ ...  â”‚ â”‚
        â”‚ 10 min   â”‚ $0.0002 â”‚ $0.01  â”‚ ...  â”‚ â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WEIGHTED SCORING & WINNER                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ For each provider:                                              â”‚
â”‚   1. Calculate average metrics across all tests                 â”‚
â”‚   2. Normalize to 0-100 scale:                                  â”‚
â”‚      - Speed Score = (1 - latency/max_latency) Ã— 100            â”‚
â”‚      - Quality Score = average quality                          â”‚
â”‚      - Cost Score = (1 - cost/max_cost) Ã— 100                   â”‚
â”‚                                                                 â”‚
â”‚   3. Weighted Total Score:                                      â”‚
â”‚      Total = (Quality Ã— 0.5) + (Speed Ã— 0.3) + (Cost Ã— 0.2)    â”‚
â”‚                                                                 â”‚
â”‚   4. Select Winner:                                             â”‚
â”‚      Winner = Provider with highest weighted total              â”‚
â”‚                                                                 â”‚
â”‚ Output:                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚   â”‚ ğŸ† Winner: Codeer Claude Sonnet   â”‚                        â”‚
â”‚   â”‚ Weighted Score: 87.5 / 100        â”‚                        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SAVE RESULTS TO FILE                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ File: experiment_results.json                                   â”‚
â”‚                                                                 â”‚
â”‚ Structure:                                                      â”‚
â”‚ {                                                               â”‚
â”‚   "timestamp": "2025-12-11T10:30:00",                           â”‚
â”‚   "test_config": {                                              â”‚
â”‚     "durations": [8, 9, 10],                                    â”‚
â”‚     "providers": [...]                                          â”‚
â”‚   },                                                            â”‚
â”‚   "results": [                                                  â”‚
â”‚     {                                                           â”‚
â”‚       "provider": "gemini",                                     â”‚
â”‚       "model": "gemini-2.0-flash-exp",                          â”‚
â”‚       "duration_minutes": 8,                                    â”‚
â”‚       "topic": "å­©å­ä¸é¡˜æ„åšåŠŸèª²",                                â”‚
â”‚       "analysis": {...},                                        â”‚
â”‚       "latency_ms": 1234,                                       â”‚
â”‚       "quality_score": {...},                                   â”‚
â”‚       "cost_data": {...}                                        â”‚
â”‚     },                                                          â”‚
â”‚     ...                                                         â”‚
â”‚   ]                                                             â”‚
â”‚ }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                        âœ“ COMPLETE
```

## é—œéµæ±ºç­–é»

### 1. Provider Selection
- **Gemini**: ä½¿ç”¨ explicit context caching (Strategy A)
- **Codeer**: ä½¿ç”¨ session pool for chat reuse

### 2. Quality Evaluation
- **Automated**: åŸºæ–¼è¦å‰‡å’Œé—œéµå­—ï¼ˆå¿«é€Ÿã€å¯é‡è¤‡ï¼‰
- **Limitations**: ç„¡æ³•å®Œå…¨å–ä»£äººå·¥è©•ä¼°

### 3. Cost Calculation
- **Gemini**: ç²¾ç¢ºï¼ˆåŸºæ–¼ token usageï¼‰
- **Codeer**: ä¼°ç®—ï¼ˆéœ€ç¢ºèªå¯¦éš›å®šåƒ¹ï¼‰

### 4. Winner Selection
- **Weighted**: Quality 50%, Speed 30%, Cost 20%
- **Rationale**: å“è³ªæœ€é‡è¦ï¼Œé€Ÿåº¦æ¬¡ä¹‹ï¼Œæˆæœ¬æœ€å¾Œ

## ä½¿ç”¨ç¯„ä¾‹

### Example 1: å®Œæ•´å¯¦é©—
```bash
poetry run python scripts/compare_four_providers.py

# Output:
# - 12 tests (3 durations Ã— 4 providers)
# - ~5-10 minutes total
# - 3 comparison tables
# - Winner recommendation
# - Saved to experiment_results.json
```

### Example 2: å¿«é€Ÿé©—è­‰ï¼ˆå–®ä¸€ providerï¼‰
```bash
poetry run python scripts/compare_four_providers.py \
  --provider gemini \
  --duration 8

# Output:
# - 1 test (8min Gemini)
# - ~30 seconds
# - Quick quality check
```

### Example 3: Codeer æ¨¡å‹æ¯”è¼ƒ
```bash
poetry run python scripts/compare_four_providers.py \
  --provider codeer

# Output:
# - 9 tests (3 durations Ã— 3 Codeer models)
# - Compare Claude vs Gemini vs GPT-5
```

## æ“´å±•æ€§

### è¼•é¬†æ·»åŠ æ–° Provider
```python
# In run_experiment():
providers_config = [
    ("gemini", "gemini-2.0-flash-exp"),
    ("codeer", "claude-sonnet"),
    ("codeer", "gemini-flash"),
    ("codeer", "gpt5-mini"),
    # Add new provider here:
    # ("openai", "gpt-4"),
]
```

### è¼•é¬†æ·»åŠ æ–°æ¸¬è©¦æ•¸æ“š
```json
// In tests/data/long_transcripts.json:
{
  "8min": {...},
  "9min": {...},
  "10min": {...},
  "12min": {  // Add new duration
    "duration_minutes": 12,
    "topic": "æ–°ä¸»é¡Œ",
    "transcript": "...",
    "speakers": [...]
  }
}
```

### èª¿æ•´è©•åˆ†æ¬Šé‡
```python
# In evaluate_quality():
total_score = (
    scores["structure"] * 0.2      # Adjust weight
    + scores["relevance"] * 0.3
    + scores["professionalism"] * 0.3
    + scores["completeness"] * 0.2
)

# In analyze_results():
weighted_total = (
    quality_score * 0.5   # Adjust weight
    + speed_score * 0.3
    + cost_score * 0.2
)
```

---

**Workflow Version**: v1.0
**Last Updated**: 2025-12-11
