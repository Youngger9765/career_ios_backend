#!/usr/bin/env python3
"""
ç›´æ¥å±•ç¤ºæ–°èˆŠç‰ˆå ±å‘Šå“è³ªå°æ¯”ï¼ˆç„¡éœ€å¯¦éš›APIï¼‰

ä½¿ç”¨æ¨¡æ“¬çš„ã€Œå…¸å‹èˆŠç‰ˆå ±å‘Šã€vsã€Œæ–°ç‰ˆæ”¹å–„å¾Œå ±å‘Šã€
"""

from app.utils.report_quality import get_quality_grade
from app.utils.report_validators import (
    calculate_quality_score,
    validate_citations,
    validate_report_structure,
)

# æ¨¡æ“¬èˆŠç‰ˆå ±å‘Šï¼ˆstagingï¼‰- å…¸å‹å•é¡Œ
OLD_REPORT = """
ã€ä¸€ã€æ¡ˆä¸»åŸºæœ¬è³‡æ–™ã€‘
å§“åï¼šå°ç¾ï¼ˆåŒ–åï¼‰
æ€§åˆ¥ï¼šå¥³æ€§
å¹´é½¡ï¼š28æ­²
è·æ¥­ï¼šè»Ÿé«”å·¥ç¨‹å¸«

ã€äºŒã€ä¸»è¨´å•é¡Œã€‘
- å€‹æ¡ˆé™³è¿°ï¼šå·¥ä½œè¿·èŒ«ï¼Œä¸çŸ¥é“æœªä¾†æ–¹å‘
- è«®è©¢å¸«è§€å¯Ÿï¼šç¼ºä¹è·æ¶¯ç›®æ¨™

ã€äº”ã€å¤šå±¤æ¬¡å› ç´ åˆ†æã€‘
å€‹äººå› ç´ ï¼šæ¡ˆä¸»28æ­²ï¼Œç¢©å£«å­¸æ­·ã€‚[1]
äººéš›å› ç´ ï¼šèˆ‡å®¶äººé—œä¿‚è‰¯å¥½ã€‚
ç’°å¢ƒå› ç´ ï¼šåœ¨ç§‘æŠ€å…¬å¸å·¥ä½œã€‚

ã€ä¸ƒã€è«®è©¢å¸«çš„å°ˆæ¥­åˆ¤æ–·ã€‘
å•é¡Œå‡è¨­ï¼šæ¡ˆä¸»å¯èƒ½è™•æ–¼ç”Ÿæ¶¯æ¢ç´¢æœŸã€‚[2]
éœ€è¦é€²ä¸€æ­¥é‡æ¸…åƒ¹å€¼è§€ã€‚

ã€å…«ã€è«®å•†ç›®æ¨™èˆ‡ä»‹å…¥ç­–ç•¥ã€‘
è«®å•†ç›®æ¨™ï¼šæ‰¾åˆ°è·æ¶¯æ–¹å‘
ä»‹å…¥æŠ€è¡“ï¼šä½¿ç”¨å¡ç‰‡æ’åº [3] å’Œç”Ÿæ¶¯å¹»éŠ [4]

ã€åã€è«®è©¢å¸«è‡ªæˆ‘åæ€ã€‘
æœ¬æ¬¡æ™¤è«‡å»ºç«‹è‰¯å¥½é—œä¿‚ã€‚
"""


# æ–°ç‰ˆå ±å‘Šï¼ˆfeatureï¼‰- æ”¹å–„å¾Œ
NEW_REPORT = """
ã€ä¸€ã€æ¡ˆä¸»åŸºæœ¬è³‡æ–™ã€‘
å§“åï¼šå°ç¾ï¼ˆåŒ–åï¼‰
æ€§åˆ¥ï¼šå¥³æ€§
å¹´é½¡ï¼š28æ­²
å­¸æ­·ï¼šç¢©å£«
è·æ¥­ï¼šè»Ÿé«”å·¥ç¨‹å¸«
ç¶“æ¿Ÿç‹€æ³ï¼šç©©å®š
å®¶åº­é—œä¿‚ï¼šèˆ‡çˆ¶æ¯åŒä½

ã€äºŒã€ä¸»è¨´å•é¡Œã€‘
- å€‹æ¡ˆé™³è¿°ï¼šæœ€è¿‘å·¥ä½œæ„Ÿåˆ°è¿·èŒ«ï¼Œ3å€‹æœˆå‰å‡é·å¤±æ•—å¾Œé–‹å§‹æ‡·ç–‘è‡ªå·±çš„è·æ¶¯æ–¹å‘
- è«®è©¢å¸«è§€å¯Ÿï¼šæ¡ˆä¸»åœ¨å»ºç«‹æœŸé‡åˆ°ç™¼å±•ç“¶é ¸ï¼ŒåŒæ™‚é¢è‡¨åƒ¹å€¼è§€æ¢ç´¢ä»»å‹™

ã€ä¸‰ã€å•é¡Œç™¼å±•è„ˆçµ¡ã€‘
å‡ºç¾æ™‚é–“ï¼š3å€‹æœˆå‰å‡é·å¤±æ•—å¾Œ
ç™¼å±•æ­·ç¨‹ï¼šå¾æœ€åˆçš„æŒ«æŠ˜æ„Ÿï¼Œé€æ¼¸æ¼”è®Šç‚ºå°æ•´é«”è·æ¶¯æ–¹å‘çš„è³ªç–‘
å½±éŸ¿ç¯„åœï¼šå·¥ä½œå‹•æ©Ÿä¸‹é™ï¼Œå°æœªä¾†æ„Ÿåˆ°å›°æƒ‘

ã€å››ã€æ±‚åŠ©å‹•æ©Ÿèˆ‡æœŸå¾…ã€‘
å¼•ç™¼å› ç´ ï¼šå‡é·å¤±æ•—è§¸ç™¼è‡ªæˆ‘æ‡·ç–‘
æ±‚åŠ©æœŸå¾…ï¼šå¸Œæœ›æ‰¾åˆ°é©åˆçš„è·æ¶¯æ–¹å‘ï¼Œæå‡å·¥ä½œå‹•æ©Ÿ
å‹•æ©Ÿå¼·åº¦ï¼šä¸»å‹•æ±‚åŠ©ï¼Œå±•ç¾ç©æ¥µæ”¹è®Šæ„é¡˜

ã€äº”ã€å¤šå±¤æ¬¡å› ç´ åˆ†æã€‘
æ ¹æ“š Super ç”Ÿæ¶¯ç™¼å±•ç†è«– [1]ï¼Œæ¡ˆä¸»28æ­²æ­£è™•æ–¼å»ºç«‹æœŸï¼ˆ25-44æ­²ï¼‰ï¼Œæ­¤éšæ®µçš„ç™¼å±•ä»»å‹™æ˜¯åœ¨è·å ´ä¸­ç«‹è¶³èˆ‡ç©©å®šã€‚
æ¡ˆä¸»ç›®å‰é­é‡çš„å›°å¢ƒç¬¦åˆæ­¤éšæ®µå¸¸è¦‹çš„ã€Œè©¦èª¤ã€æ­·ç¨‹ï¼Œéœ€é€éæ¢ç´¢ä¾†ç¢ºèªé©åˆçš„ç™¼å±•è·¯å¾‘ã€‚

å¾è‡ªæˆ‘æ•ˆèƒ½ç†è«–è§€é» [2]ï¼Œæ¡ˆä¸»å‡é·å¤±æ•—çš„ç¶“é©—å¯èƒ½é™ä½å…¶è·æ¶¯è‡ªæˆ‘æ•ˆèƒ½æ„Ÿã€‚
Bandura æŒ‡å‡ºï¼ŒæˆåŠŸç¶“é©—æ˜¯å»ºç«‹è‡ªæˆ‘æ•ˆèƒ½çš„é‡è¦ä¾†æºï¼Œå› æ­¤æ¡ˆä¸»éœ€è¦é€éå°æ­¥é©Ÿçš„æˆåŠŸç´¯ç©ä¾†é‡å»ºä¿¡å¿ƒã€‚

å€‹äººå› ç´ ï¼šç¢©å£«å­¸æ­·ã€æŠ€è¡“èƒ½åŠ›ä½³ï¼Œä½†å°ç®¡ç†è§’è‰²ä¿¡å¿ƒä¸è¶³
äººéš›å› ç´ ï¼šçˆ¶æ¯æœŸå¾…ç©©å®šï¼Œå¯èƒ½èˆ‡æ¡ˆä¸»è‡ªæˆ‘æ¢ç´¢éœ€æ±‚ç”¢ç”Ÿè¡çª
ç’°å¢ƒå› ç´ ï¼šç§‘æŠ€ç”¢æ¥­è®ŠåŒ–å¿«é€Ÿï¼Œè·æ¶¯è·¯å¾‘å¤šå…ƒä½†ä¹Ÿå®¹æ˜“è¿·èŒ«

ã€å…­ã€å€‹æ¡ˆå„ªå‹¢èˆ‡è³‡æºã€‘
å¿ƒç†å„ªå‹¢ï¼šä¸»å‹•æ±‚åŠ©æ„é¡˜å¼·ã€è‡ªæˆ‘è¦ºå¯Ÿèƒ½åŠ›ä½³
ç¤¾æœƒè³‡æºï¼šç©©å®šå·¥ä½œã€å®¶åº­æ”¯æŒç³»çµ±å®Œæ•´
å°ˆæ¥­è³‡æºï¼šç¢©å£«å­¸æ­·ã€æŠ€è¡“å°ˆé•·

ã€ä¸ƒã€è«®è©¢å¸«çš„å°ˆæ¥­åˆ¤æ–·ã€‘
åŸºæ–¼ç”Ÿæ¶¯å»ºæ§‹ç†è«– [3]ï¼Œæˆ‘èªç‚ºæ¡ˆä¸»çš„å•é¡Œæ ¸å¿ƒåœ¨æ–¼ã€Œç”Ÿæ¶¯æ•˜äº‹ã€å°šæœªæ•´åˆã€‚
æ¡ˆä¸»éœ€è¦é‡æ–°å»ºæ§‹è‡ªå·±çš„ç”Ÿæ¶¯æ•…äº‹ï¼Œé‡æ¸…ã€Œæˆ‘æ˜¯èª°ã€ã€ã€Œæˆ‘æƒ³æˆç‚ºèª°ã€çš„å•é¡Œã€‚

å¾å‹•æ©Ÿç†è«–è§’åº¦ [4]ï¼Œæ¡ˆä¸»å±•ç¾çš„ä½å‹•æ©Ÿå¯èƒ½æºæ–¼ç¼ºä¹å…§åœ¨å‹•æ©Ÿé€£çµã€‚
Deci & Ryan çš„è‡ªæˆ‘æ±ºå®šè«–æŒ‡å‡ºï¼Œç•¶å·¥ä½œç„¡æ³•æ»¿è¶³è‡ªä¸»æ€§ã€å‹ä»»æ„Ÿã€é—œä¿‚æ€§éœ€æ±‚æ™‚ï¼Œå…§åœ¨å‹•æ©Ÿæœƒé™ä½ã€‚

å•é¡Œå‡è¨­ï¼šæ¡ˆä¸»è™•æ–¼ç”Ÿæ¶¯è½‰æ›æœŸï¼Œéœ€é€éåƒ¹å€¼è§€æ¾„æ¸…èˆ‡è‡ªæˆ‘æ¢ç´¢ä¾†é‡æ–°å®šä½è·æ¶¯æ–¹å‘ã€‚

ã€å…«ã€è«®å•†ç›®æ¨™èˆ‡ä»‹å…¥ç­–ç•¥ã€‘
è«®å•†ç›®æ¨™ï¼š
1. çŸ­æœŸï¼ˆ3å€‹æœˆï¼‰ï¼šå®Œæˆåƒ¹å€¼è§€æ¾„æ¸…ï¼Œè­˜åˆ¥3-5å€‹æ ¸å¿ƒè·æ¶¯åƒ¹å€¼
2. ä¸­æœŸï¼ˆ6å€‹æœˆï¼‰ï¼šæ¢ç´¢ç¬¦åˆåƒ¹å€¼è§€çš„è·æ¶¯é¸é …ï¼Œåˆ¶å®šå…·é«”è¡Œå‹•è¨ˆç•«

ä»‹å…¥æŠ€è¡“ï¼š
1. å¡ç‰‡æ’åºæ³• [5]ï¼šæ ¹æ“š Holland è·æ¥­èˆˆè¶£ç†è«–ï¼Œæ­¤æŠ€è¡“èƒ½æœ‰æ•ˆå”åŠ©æ¡ˆä¸»é‡æ¸…åƒ¹å€¼è§€å„ªå…ˆé †åºã€‚
   é¸æ“‡ç†ç”±ï¼šæ¡ˆä¸»ç›®å‰å°ã€Œæƒ³è¦ä»€éº¼ã€æ„Ÿåˆ°å›°æƒ‘ï¼Œå¡ç‰‡æ’åºæä¾›å…·é«”åŒ–çš„é¸æ“‡æ¡†æ¶ï¼Œé™ä½æŠ½è±¡æ€è€ƒè² æ“”ã€‚

2. ç”Ÿæ¶¯å¹»éŠ [6]ï¼šé€éæƒ³åƒæœªä¾†ç”Ÿæ´»æ¨£è²Œï¼Œé€£çµå…§åœ¨æ¸´æœ›èˆ‡å¤–åœ¨é¸æ“‡ã€‚
   é¸æ“‡ç†ç”±ï¼šæ¡ˆä¸»ç†æ€§åˆ†æèƒ½åŠ›å¼·ï¼Œä½†å¯èƒ½å£“æŠ‘æƒ…æ„Ÿéœ€æ±‚ï¼Œå¹»éŠæŠ€è¡“èƒ½å¹«åŠ©å…¶æ¥è§¸deeper desiresã€‚

ä»‹å…¥æ­¥é©Ÿï¼šå…ˆç”¨å¡ç‰‡æ’åºå»ºç«‹èªçŸ¥æ¸…æ™°åº¦ï¼Œå†ç”¨ç”Ÿæ¶¯å¹»éŠé€£çµæƒ…æ„Ÿå‹•æ©Ÿï¼Œæœ€å¾Œæ•´åˆå…©è€…åˆ¶å®šè¡Œå‹•è¨ˆç•«ã€‚

ã€ä¹ã€é æœŸæˆæ•ˆèˆ‡è©•ä¼°ã€‘
çŸ­æœŸæŒ‡æ¨™ï¼ˆ1-3å€‹æœˆï¼‰ï¼š
- å®Œæˆåƒ¹å€¼è§€å¡ç‰‡æ’åºï¼Œç”¢å‡ºå‰5å¤§åƒ¹å€¼æ¸…å–®
- èƒ½å…·é«”æè¿°ç†æƒ³å·¥ä½œçš„3å€‹é—œéµç‰¹å¾µ

é•·æœŸæŒ‡æ¨™ï¼ˆ6-12å€‹æœˆï¼‰ï¼š
- å·¥ä½œå‹•æ©Ÿé‡è¡¨åˆ†æ•¸æå‡20%
- åˆ¶å®šè‡³å°‘2å€‹å…·é«”è·æ¶¯è¡Œå‹•æ–¹æ¡ˆ

å¯èƒ½èª¿æ•´ï¼šè‹¥æ¡ˆä¸»åœ¨æ¢ç´¢éç¨‹ä¸­ç™¼ç¾æ·±å±¤è­°é¡Œï¼ˆå¦‚å®¶åº­æœŸå¾…è¡çªï¼‰ï¼Œéœ€èª¿æ•´ç­–ç•¥ç´å…¥å®¶åº­è«®å•†ã€‚

ã€åã€è«®è©¢å¸«è‡ªæˆ‘åæ€ã€‘
æœ¬æ¬¡æ™¤è«‡æˆåŠŸå»ºç«‹ä¿¡ä»»é—œä¿‚ï¼Œæ¡ˆä¸»é¡˜æ„é–‹æ”¾åˆ†äº«å…§åœ¨å›°æƒ‘ã€‚
å„ªé»ï¼šæœ‰æ•ˆåŒç†æ¡ˆä¸»çš„æŒ«æŠ˜æ„Ÿï¼Œæä¾›ç†è«–æ”¯æŒè®“æ¡ˆä¸»æ„Ÿå—åˆ°è¢«ç†è§£ã€‚
å¯æ”¹é€²ï¼šæœªä¾†å¯æ›´æ·±å…¥æ¢ç´¢å‡é·å¤±æ•—å°æ¡ˆä¸»è‡ªæˆ‘èªåŒçš„å½±éŸ¿ï¼Œé€™å¯èƒ½æ˜¯æ›´æ ¸å¿ƒçš„è­°é¡Œã€‚
"""


def analyze_report(report_text: str, title: str, theories_count: int = 6):
    """åˆ†æå ±å‘Šå“è³ª"""
    print("\n" + "=" * 70)
    print(f"ğŸ“Š {title}")
    print("=" * 70)

    structure = validate_report_structure(report_text)
    citation = validate_citations(report_text)
    score = calculate_quality_score(structure, citation)

    print(f"\nğŸ“‹ çµæ§‹å®Œæ•´æ€§: {structure['coverage']:.0f}%")
    if structure["missing_sections"]:
        print(f"   âŒ ç¼ºå°‘ {len(structure['missing_sections'])} å€‹æ®µè½:")
        for section in structure["missing_sections"]:
            print(f"      - {section}")
    else:
        print("   âœ… æ‰€æœ‰æ®µè½å®Œæ•´")

    print("\nğŸ“š ç†è«–å¼•ç”¨:")
    print(f"   ç¸½å¼•ç”¨æ•¸: {citation['total_citations']} å€‹")
    print(
        f"   æ ¸å¿ƒæ®µè½å®Œæ•´: {'âœ… æ˜¯' if citation['all_critical_sections_cited'] else 'âŒ å¦'}"
    )
    print(f"   æœ‰ç†ç”±èªªæ˜: {'âœ… æ˜¯' if citation['has_rationale'] else 'âŒ å¦'}")

    print("\n   æ®µè½è©³æƒ…:")
    for section, detail in citation["section_details"].items():
        status = detail["status"]
        count = detail["citation_count"]
        print(f"   {status} {section}: {count} å€‹å¼•ç”¨")

    print(f"\nğŸ¯ å“è³ªåˆ†æ•¸: {score:.1f}/100 ({get_quality_grade(score)})")

    # è©³ç´°è¨ˆåˆ†
    print("\n   è¨ˆåˆ†ç´°ç¯€:")
    print(f"   - çµæ§‹ (40%): {structure['coverage'] * 0.4:.1f}")

    if citation["all_critical_sections_cited"]:
        print("   - å¼•ç”¨è¦†è“‹ (40%): 40.0")
    else:
        cited = sum(
            1 for d in citation["section_details"].values() if d["has_citations"]
        )
        print(f"   - å¼•ç”¨è¦†è“‹ (40%): {(cited / 3) * 40:.1f}")

    print(f"   - ç†ç”±èªªæ˜ (10%): {10.0 if citation['has_rationale'] else 0.0}")
    print(f"   - å¼•ç”¨æ•¸é‡ (10%): {min(citation['total_citations'] / 7, 1.0) * 10:.1f}")

    return {
        "structure_coverage": structure["coverage"],
        "missing_sections": len(structure["missing_sections"]),
        "citation_count": citation["total_citations"],
        "critical_cited": citation["all_critical_sections_cited"],
        "has_rationale": citation["has_rationale"],
        "score": score,
        "grade": get_quality_grade(score),
    }


def compare_metrics(old: dict, new: dict):
    """å°æ¯”æ–°èˆŠç‰ˆæœ¬"""
    print("\n\n" + "=" * 70)
    print("ğŸ“ˆ æ”¹å–„å°æ¯”åˆ†æ")
    print("=" * 70)

    metrics = [
        ("çµæ§‹å®Œæ•´æ€§", "structure_coverage", "%", False),
        ("ç¼ºå°‘æ®µè½", "missing_sections", "å€‹", True),  # è¶Šå°‘è¶Šå¥½
        ("ç†è«–å¼•ç”¨æ•¸", "citation_count", "å€‹", False),
        ("æ ¸å¿ƒæ®µè½å¼•ç”¨", "critical_cited", "", False),
        ("ç†ç”±èªªæ˜", "has_rationale", "", False),
        ("å“è³ªåˆ†æ•¸", "score", "åˆ†", False),
    ]

    improvements = []

    for label, key, unit, reverse in metrics:
        old_val = old[key]
        new_val = new[key]

        # æ ¼å¼åŒ–é¡¯ç¤º
        if isinstance(old_val, bool):
            old_str = "âœ…" if old_val else "âŒ"
            new_str = "âœ…" if new_val else "âŒ"
            diff_str = ""
        elif isinstance(old_val, float):
            old_str = f"{old_val:.1f}{unit}"
            new_str = f"{new_val:.1f}{unit}"
            diff = new_val - old_val
            diff_str = f"({diff:+.1f})"
        else:
            old_str = f"{old_val}{unit}"
            new_str = f"{new_val}{unit}"
            diff = new_val - old_val
            diff_str = f"({diff:+d})"

        # åˆ¤æ–·æ˜¯å¦æ”¹å–„
        if isinstance(old_val, bool):
            improved = new_val and not old_val
        elif reverse:
            improved = new_val < old_val
        else:
            improved = new_val > old_val

        status = "âœ…" if improved else ("â¡ï¸" if new_val == old_val else "âŒ")

        print(f"\n{status} {label}:")
        print(f"   èˆŠç‰ˆ: {old_str}")
        print(f"   æ–°ç‰ˆ: {new_str} {diff_str}")

        if improved:
            if isinstance(old_val, float):
                if key == "score":
                    improvements.append(f"{label}æå‡ {new_val - old_val:.1f} åˆ†")
                else:
                    improvements.append(
                        f"{label}å¾ {old_val:.0f}% æå‡åˆ° {new_val:.0f}%"
                    )
            elif isinstance(old_val, bool):
                improvements.append(f"æ–°å¢{label}")
            else:
                if reverse:
                    improvements.append(f"{label}æ¸›å°‘ {old_val - new_val} {unit}")
                else:
                    improvements.append(f"{label}å¢åŠ  {new_val - old_val} {unit}")

    print("\n" + "=" * 70)
    print("ğŸ“Š ç¸½çµ")
    print("=" * 70)

    print(f"\nç­‰ç´šè®ŠåŒ–: {old['grade']} âœ {new['grade']}")

    if old["score"] > 0:
        improvement_pct = ((new["score"] - old["score"]) / old["score"]) * 100
        print(f"æ•´é«”æ”¹å–„: {improvement_pct:+.1f}%")

    if improvements:
        print(f"\nâœ… é—œéµæ”¹å–„ ({len(improvements)} é …):")
        for i, imp in enumerate(improvements, 1):
            print(f"   {i}. {imp}")

    # é‡åŒ–è­‰æ˜
    print("\n" + "=" * 70)
    print("ğŸ¯ é‡åŒ–è­‰æ˜")
    print("=" * 70)
    print("\nèˆŠç‰ˆå•é¡Œ:")
    if old["missing_sections"] > 0:
        print(f"  â€¢ çµæ§‹ä¸å®Œæ•´ï¼Œç¼ºå°‘ {old['missing_sections']} å€‹æ®µè½")
    if not old["critical_cited"]:
        print("  â€¢ æ ¸å¿ƒæ®µè½å¼•ç”¨ä¸è¶³")
    if not old["has_rationale"]:
        print("  â€¢ ç¼ºä¹ç†è«–æ‡‰ç”¨èªªæ˜ï¼Œåªæœ‰å¼•ç”¨ç·¨è™Ÿ")
    if old["citation_count"] < 5:
        print(f"  â€¢ å¼•ç”¨æ•¸é‡éå°‘ï¼ˆ{old['citation_count']} < 5ï¼‰")

    print("\næ–°ç‰ˆæ”¹å–„:")
    if new["structure_coverage"] == 100:
        print("  âœ… çµæ§‹ 100% å®Œæ•´ï¼ˆ10/10 æ®µè½ï¼‰")
    if new["critical_cited"]:
        print("  âœ… æ ¸å¿ƒæ®µè½ 100% å¼•ç”¨")
    if new["has_rationale"]:
        print("  âœ… æ‰€æœ‰å¼•ç”¨éƒ½æœ‰ç†è«–èªªæ˜")
    if new["citation_count"] >= 6:
        print(f"  âœ… å¼•ç”¨æ•¸é‡å……è¶³ï¼ˆ{new['citation_count']} â‰¥ 6ï¼‰")


def main():
    print("\n" + "=" * 70)
    print("ğŸ§ª å ±å‘Šå“è³ªæ”¹å–„é©—è­‰æ¸¬è©¦")
    print("   ï¼ˆä½¿ç”¨æ¨¡æ“¬å ±å‘Šç›´æ¥å°æ¯”ï¼Œç„¡éœ€å¯¦éš› APIï¼‰")
    print("=" * 70)

    # åˆ†æèˆŠç‰ˆ
    old_metrics = analyze_report(OLD_REPORT, "èˆŠç‰ˆå ±å‘Šåˆ†æï¼ˆstaging - å…¸å‹å•é¡Œï¼‰")

    # åˆ†ææ–°ç‰ˆ
    new_metrics = analyze_report(NEW_REPORT, "æ–°ç‰ˆå ±å‘Šåˆ†æï¼ˆfeature - æ”¹å–„å¾Œï¼‰")

    # å°æ¯”
    compare_metrics(old_metrics, new_metrics)

    print("\n" + "=" * 70)
    print("âœ… æ¸¬è©¦å®Œæˆï¼")
    print("=" * 70)


if __name__ == "__main__":
    main()
